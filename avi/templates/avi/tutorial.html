<!--
Copyright (C) 2016-2018 Quasar Science Resources, S.L.

This file is part of DEAVI.

DEAVI is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

DEAVI is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with DEAVI.  If not, see <http://www.gnu.org/licenses/>.
-->
<!DOCTYPE html>
<html lang="en">

<head>
    {% include "avi/header.html" %} {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'avi/css/pygments.css' %}" />
</head>

<body>
    <div>
        {% include "avi/navbar.html" %}
    </div>
    <div class="container-fluid">
        <div id="" class="row content">

            {% include "avi/sidebar-nav.html" with sidebar_menu="guide" %}

            <div id="real-content" class="col cont">
                <!-- ------------------------------------------------------------- -->
                <script>
                        var x = 0;
                        $(document).ready(function(){
                          $(window).resize(function(){
                              if($( window ).width() < 414){
                                document.getElementById('real-content').className = "col-9 cont";
                              }else{
                                document.getElementById('real-content').className = "col cont";
                              }
                          });
                          if($( window ).width() < 414){
                                document.getElementById('real-content').className = "col-9 cont";
                              }else{
                                document.getElementById('real-content').className = "col cont";
                              }
                        });
                </script>
                <!-- ------------------------------------------------------------- -->
                <!-- ------------------------------------------------------------- -->
                {% load static %}
                <div id="card" class="card bg-light mb-3">
                    <div class="card-header">
                        <h1>Tutorials</h1>
                        <hr>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                    <nav style="position: sticky !important; top: 0 !important; background-color: #F8F9FA">
                                            <div class="nav nav-tabs" id="nav-tab" role="tablist">
                                                <a class="nav-item nav-link active" id="nav-plotting-Gaia-tab" onclick="scroll_to_top()" data-toggle="tab" href="#nav-plotting-Gaia" role="tab" aria-controls="nav-plotting-Gaia" aria-selected="true">Gaia</a>
                                                <a class="nav-item nav-link" id="nav-HRD-tab" onclick="scroll_to_top()" data-toggle="tab" href="#nav-HRD" role="tab" aria-controls="nav-HRD" aria-selected="false">HRD</a>
                                                <a class="nav-item nav-link" id="nav-Gaia-Herschel-tab" onclick="scroll_to_top()" data-toggle="tab" href="#nav-Gaia-Herschel" role="tab" aria-controls="nav-Gaia-Herschel" aria-selected="false">Gaia and Herschel</a>
                                                <a class="nav-item nav-link" id="nav-query-gaia-tab" onclick="scroll_to_top()" data-toggle="tab" href="#nav-query-gaia" role="tab" aria-controls="nav-query-gaia" aria-selected="false">Gaia Archive</a>
                                                <a class="nav-item nav-link" id="nav-query-hsa-tab" onclick="scroll_to_top()" data-toggle="tab" href="#nav-query-hsa" role="tab" aria-controls="nav-query-hsa" aria-selected="false">Herschel Archive</a>
                                                <a class="nav-item nav-link" id="nav-queries-status-tab" onclick="scroll_to_top()" data-toggle="tab" href="#nav-queries-status" role="tab" aria-controls="nav-queries-status" aria-selected="false">Queries Status</a>
                                                <a class="nav-item nav-link" id="nav-use-algorithm-gaia-tab" onclick="scroll_to_top()" data-toggle="tab" href="#nav-use-algorithm-gaia" role="tab" aria-controls="nav-use-algorithm-gaia" aria-selected="false">Use Algorithm Gaia</a>
                                                <a class="nav-item nav-link" id="nav-use-algorithm-gaia-hsa-tab" onclick="scroll_to_top()" data-toggle="tab" href="#nav-use-algorithm-gaia-hsa" role="tab" aria-controls="nav-use-algorithm-gaia-hsa" aria-selected="false">Use Algorithm Gaia HSA</a>
                                                <a class="nav-item nav-link" id="nav-use-algorithm-hrd-tab" onclick="scroll_to_top()" data-toggle="tab" href="#nav-use-algorithm-hrd" role="tab" aria-controls="nav-use-algorithm-hrd" aria-selected="false">Use Algorithm HRD</a>
                                                <a class="nav-item nav-link" id="nav-files-tab" onclick="scroll_to_top()" data-toggle="tab" href="#nav-files" role="tab" aria-controls="nav-files" aria-selected="false">My Files</a>
                                            </div>
                                        </nav>
                                        <div class="tab-content" id="nav-tabContent">
                                            <div class="tab-pane fade show active" id="nav-plotting-Gaia" role="tabpanel" aria-labelledby="nav-plotting-Gaia-tab">
                                                    <h3 class="text-left mt-3"><b>1 - Plotting Gaia data with their proper motions</b></h3>
                                                    <p class="text">This algorithm plots the positions of a certain number of stars in a cluster 
                                                        together with their respective proper motions. The input file is a VOTable from the Gaia Archive.</p>
                                                    <h5 class="text-left">1.1 - Gaia_pm.py</h5>
                                                    <p class="text">The first step is to create the Python file where the algorithm is defined. In our case we called it “gaia_pm”.</p>
                                                    <p class="text">As usual, we have to import the necessary modules. This algorithm uses 
                                                        <a class="a-link" href="https://numpy.org/" target="_blank">Numpy</a>, 
                                                        <a class="a-link" href="https://www.astropy.org/" target="_blank">Astropy</a>,
                                                        <a class="a-link" href="https://bokeh.pydata.org/en/latest/" target="_blank">Bokeh</a> and DEAVI libraries.</p>
                                                    <div class="highlight-python notranslate text-left">
                                                        <div class="highlight text-left p-4">
                                                        <code><p><span class="c1"># Import the necessary modules</span></p>
                    
                                                        <p><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span></p>
                                                        
                                                        <p><span class="kn">from</span> <span class="nn">astropy.io.votable</span> <span class="kn">import</span> <span class="n">parse</span></p>
                                                        
                                                        <p><span class="kn">from</span> <span class="nn">avi.utils.plotter</span> <span class="kn">import</span> <span class="n">save_plot</span></p>
                                                        <p><span class="kn">from</span> <span class="nn">avi.utils.data.data_file</span> <span class="kn">import</span> <span class="n">data_file</span> <span class="k">as</span> <span class="n">data</span></p>
                                                        
                                                        <p><span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span></p>
                                                        <p><span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">Arrow</span><span class="p">,</span> <span class="n">VeeHead</span></p></code>
                                                        </div>
                                                    </div>
                                                    <p class="text">Next, we create the python class where the algorithm functions are implemented. This class will grow as we add functions. For now,</p>
                                                    <div class="highlight-python notranslate text-left">
                                                        <div class="highlight p-4">
                                                            <code><p><span class="k">class</span> <span class="nc">Gaia_PM</span><span class="p">:</span></p></code>
                                                        </div>
                                                    </div>
                                                    <br>
                                                    <p class="text">Once the class is created, we have to define the inputs. The algorithm will plot a set of stars with their proper motions, so we will need two inputs:</p>
                                                    <ul>
                                                        <li class="li_guide text-left">A VOTable file.</li>
                                                        <li class="li_guide text-left">The number of stars.</li>
                                                    </ul>
                                                    <div class="highlight-python notranslate text-left">
                                                        <div class="highlight p-4">
                                                            <code><pre><span class="k">class</span> <span class="nc">Gaia_PM</span><span class="p">:</span></pre>
                                                            <pre><span class="c1">  # Initialize the Gaia table</span></pre>
                                                            <pre><span class="n">   gaia_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                                                
                                                            <pre><span class="c1">  # Starts</span></pre>
                                                            <pre><span class="n">   number_stars_displayed</span> <span class="o">=</span> <span class="mf">0.0</span></pre></code>
                                                        </div>
                                                    </div>
                                                    <p class="text">In the main class we have to create a “run” function that contains all the tasks to be executed.</p>
                                                    <div class="highlight-python notranslate text-left">
                                                        <div class="highlight p-4">
                                                            <code><span class="k">class</span> <span class="nc">Gaia_PM</span><span class="p">:</span>
                                                            <pre><span class="c1">  # Initialize the Gaia table</span></pre>
                                                            <pre><span class="n">   gaia_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                                                
                                                            <pre><span class="c1">  # Starts</span></pre>
                                                            <pre><span class="n">   number_stars_displayed</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
                                        
                                                            <pre><span class="k">   def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span></pre>
                                                            <pre><span class="o">   .....</span></pre>
                                                            <pre><span class="o">   .....</span></pre>
                                                            <pre><span class="o">   .....</span></pre></code>
                                                        </div>
                                                    </div>
                                                    <ul>
                                                        <li class="li_guide text-left"><b>run function:</b></li>
                                                    </ul>
                                                    <p class="text">We will start parsing the data in the VOTable file. Next, we will import the variables of interest. 
                                                        For more information visit the 
                                                        <a class="a-link" href="https://gea.esac.esa.int/archive/documentation/GDR2/Gaia_archive/chap_datamodel/sec_dm_main_tables/ssec_dm_gaia_source.html" target="_blank">
                                                            Gaia Data Release Documnetation
                                                        </a>.</p>
                                                    <p class="text">The last step will be to plot the values ​​and save the results. Thus,</p>
                                                    <div class="highlight-python notranslate text-left">
                                                        <div class="highlight p-4"><code>
                                                        
                                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                                        <pre><span class="sd">Copyright (C) 2016-2020 Quasar Science Resources, S.L.</span></pre>
                                                        
                                                        <pre><span class="sd">This file is part of DEAVI.</span></pre>
                                                       
                                                        <pre><span class="sd">DEAVI is free software: you can redistribute it and/or modify</span></pre>
                                                        <pre><span class="sd">it under the terms of the GNU General Public License as published by</span></pre>
                                                        <pre><span class="sd">the Free Software Foundation, either version 3 of the License, or</span></pre>
                                                        <pre><span class="sd">(at your option) any later version.</span></pre>
                                                        
                                                        <pre><span class="sd">DEAVI is distributed in the hope that it will be useful,</span></pre>
                                                        <pre><span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span></pre>
                                                        <pre><span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></pre>
                                                        <pre><span class="sd">GNU General Public License for more details.</span></pre>
                                                        
                                                            <pre><span class="sd">You should have received a copy of the GNU General Public License</span></pre>
                                                            <pre><span class="sd">along with DEAVI.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></pre>
                                                            <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                                            <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                            
                                                            <pre><span class="sd">Example 1: This algorithm plots the positions of a certain number of stars in a</span></pre>
                                                            <pre><span class="sd">cluster together with their respective proper motions. The input file is a VOTable</span></pre>
                                                            <pre><span class="sd">from the Gaia Archive</span></pre>
                                                            <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                            
                                                            <pre><span class="c1"># Import the necessary modules</span></pre>
                        
                                                            <pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span></pre>
                    
                                                            <pre><span class="kn">from</span> <span class="nn">astropy.io.votable</span> <span class="kn">import</span> <span class="n">parse</span></pre>
                    
                                                            <pre><span class="kn">from</span> <span class="nn">avi.utils.plotter</span> <span class="kn">import</span> <span class="n">save_plot</span></pre>
                                                            <pre><span class="kn">from</span> <span class="nn">avi.utils.data.data_file</span> <span class="kn">import</span> <span class="n">data_file</span> <span class="k">as</span> <span class="n">data</span></pre>
                    
                                                            <pre><span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span></pre>
                                                            <pre><span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">Arrow</span><span class="p">,</span> <span class="n">VeeHead</span></pre>
                                                        
                                                        
                                                        <pre><span class="k">class</span> <span class="nc">Gaia_PM</span><span class="p">:</span></pre>
                                                            <pre>   <span class="c1"># Initialize the Gaia table</span></pre>
                                                            <pre>   <span class="n">gaia_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                                                    
                                                            <pre>   <span class="c1"># Starts</span></pre>
                                                            <pre>   <span class="n">number_stars_displayed</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
                                            
                                                            <pre>   <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span></pre>
                                                            <pre>       <span class="c1">## Gaia VOTABLE</span></pre>
                                    
                                                            <pre>       <span class="c1"># Extract the information from VOTable file</span></pre>
                                                            <pre>       <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaia_file</span><span class="p">)</span></pre>
                                                            <pre>       <span class="n">gaia_list</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="o">.</span><span class="n">get_first_table</span><span class="p">()</span><span class="o">.</span><span class="n">array</span></pre>
                    
                                                            <pre>       <span class="c1"># Parallax obtained from Gaia from the different stars changing units</span></pre>
                                                            <pre>       <span class="c1"># from mas to arcseconds</span></pre>
                                                            <pre>       <span class="c1"># https://gea.esac.esa.int/archive/documentation/GDR2/Gaia_archive/chap_datamodel/sec_dm_main_tables/ssec_dm_gaia_source.html</span></pre>
                    
                                                            <pre>       <span class="n">paralf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;parallax&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span></pre>
                    
                                                            <pre>       <span class="c1"># Selection a smaller number of stars (number_stars_displayed)</span></pre>
                    
                                                            <pre>       <span class="n">paralf</span> <span class="o">=</span> <span class="n">paralf</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_stars_displayed</span><span class="p">]</span></pre>
                    
                                                            <pre>       <span class="c1"># Get the coordinates in the cluster</span></pre>
                    
                                                            <pre>       <span class="c1"># Proper motion in declination direction (double, Angular Velocity[mas/year] )</span></pre>
                                                            <pre>       <span class="n">propermot_de_sf</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;pmdec&#39;</span><span class="p">]</span></pre>
                                                            <pre>       <span class="c1"># Proper motion in right ascension direction (double, Angular Velocity[mas/year])</span></pre>
                                                            <pre>       <span class="n">propermot_ra_sf</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;pmra&#39;</span><span class="p">]</span></pre>
                                                            <pre>       <span class="c1"># Declination (double, Angle[deg])</span></pre>
                                                            <pre>       <span class="n">dec_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span></pre>
                                                            <pre>       <span class="c1"># Right ascension (double, Angle[deg])</span></pre>
                                                            <pre>       <span class="n">ra_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span></pre>
                                                            <pre>       <span class="c1"># Stellar radius (float, Length &amp; Distance[Solar Radius])</span></pre>
                                                            <pre>       <span class="n">radiof</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;radius_val&#39;</span><span class="p">]</span></pre>
                    
                                                            <pre>       <span class="c1"># Creation of an array that will contain only  the number of the rows of</span></pre>
                                                            <pre>       <span class="c1"># stars with a known PM</span></pre>
                                                            <pre>       <span class="n">starts_with_PM</span><span class="o">=</span><span class="p">[]</span></pre>
                    
                                                            <pre>       <span class="c1"># Get index of the array with values of PM</span></pre>
                                                            <pre>       <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paralf</span><span class="p">)):</span></pre>
                                                                <pre>           <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">propermot_de_sf</span><span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">:</span></pre>
                                                                    <pre>           <span class="n">starts_with_PM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></pre>
                                                        
                                                        
                                                                    <pre>       <span class="c1"># We initialize the arrays necessary for the subsequent analysis.</span></pre>
                                                                    <pre>       <span class="n">propermot_de_sf_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">))</span></pre>
                                                                    <pre>       <span class="n">propermot_ra_sf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">))</span></pre>
                                                                    <pre>       <span class="n">dec_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">))</span></pre>
                                                                    <pre>       <span class="n">ra_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">))</span></pre>
                                                                    <pre>       <span class="n">radiof_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">))</span></pre>
                                                        
                                                                    <pre>       <span class="c1"># Function that fills the empty vectors with the real data from Gaia,</span></pre>
                                                                    <pre>       <span class="c1"># including only the stars with a known proper motion</span></pre>
                                                                    <pre>       <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">)):</span></pre>
                                                                                <pre>           <span class="c1"># The proper motions are given in arcseconds per year so they are</span></pre>
                                                                                <pre>           <span class="c1"># divided by a factor of 3600 to change the units to degrees</span></pre>
                                                                                <pre>           <span class="n">propermot_de_sf_new</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="n">propermot_de_sf</span><span class="p">[</span><span class="n">starts_with_PM</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">/</span><span class="mi">3600</span></pre>
                                                                                <pre>           <span class="n">propermot_ra_sf_new</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="n">propermot_ra_sf</span><span class="p">[</span><span class="n">starts_with_PM</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">/</span><span class="mi">3600</span></pre>
                                                                                <pre>           <span class="n">dec_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dec_colf</span><span class="p">[</span><span class="n">starts_with_PM</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                                                <pre>           <span class="n">ra_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ra_colf</span><span class="p">[</span><span class="n">starts_with_PM</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                                                <pre>           <span class="n">radiof_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">radiof</span><span class="p">[</span><span class="n">starts_with_PM</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Definition of the variables that will be used to plot the coordinates</span></pre>
                                                                        <pre>       <span class="c1"># of the stars in 2D (right ascension and declination in degrees)</span></pre>
                                                                        <pre>       <span class="n">x</span> <span class="o">=</span> <span class="n">ra_colf_new</span></pre>
                                                                        <pre>       <span class="n">y</span> <span class="o">=</span> <span class="n">dec_colf_new</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Definition of the variables that will be used to plot the proper</span></pre>
                                                                        <pre>       <span class="c1"># motions of the stars in 2D in degrees per year (they are multiplied by</span></pre>
                                                                        <pre>       <span class="c1"># a factor of 10 to make the proportions more visually understandable in</span></pre>
                                                                        <pre>       <span class="c1"># the plot)</span></pre>
                                                        
                                                                        <pre>       <span class="n">u</span> <span class="o">=</span> <span class="n">propermot_ra_sf_new</span><span class="o">*</span><span class="mi">10</span></pre>
                                                                        <pre>       <span class="n">v</span> <span class="o">=</span> <span class="n">propermot_de_sf_new</span><span class="o">*</span><span class="mi">10</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Definition of the graph range and selection of an adequate margin</span></pre>
                                                                        <pre>       <span class="n">margin</span> <span class="o">=</span> <span class="mf">0.07</span></pre>
                                                                        <pre>       <span class="n">max_ra</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ra_colf_new</span><span class="p">)</span> <span class="o">+</span> <span class="n">margin</span></pre>
                                                                        <pre>       <span class="n">min_ra</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ra_colf_new</span><span class="p">)</span> <span class="o">-</span> <span class="n">margin</span></pre>
                                                                        <pre>       <span class="n">max_de</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dec_colf_new</span><span class="p">)</span> <span class="o">+</span> <span class="n">margin</span></pre>
                                                                        <pre>       <span class="n">min_de</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dec_colf_new</span><span class="p">)</span> <span class="o">-</span> <span class="n">margin</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Definition of the function that plots the stars and the arrows that</span></pre>
                                                                        <pre>       <span class="c1"># represent the proper motions</span></pre>
                                                                        <pre>       <span class="k">def</span> <span class="nf">radvel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">max_ra</span><span class="p">,</span> <span class="n">min_ra</span><span class="p">,</span> <span class="n">max_de</span><span class="p">,</span> <span class="n">min_de</span><span class="p">):</span></pre>
                                                                            <pre>           <span class="c1"># Creation of the image</span></pre>
                                                                                <pre>           <span class="n">p</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Proper motions&quot;</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="n">min_ra</span><span class="p">,</span><span class="n">max_ra</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="n">min_de</span><span class="p">,</span><span class="n">max_de</span><span class="p">))</span></pre>
                                                                                <pre>           <span class="c1"># Creation of the points that represent the stars and their color</span></pre>
                                                                                <pre>           <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#FFD700&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;#FF8C00&quot;</span> <span class="p">,</span><span class="n">radius</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">)</span></pre>
                                                                                <pre>           <span class="c1"># Title of the axis and units</span></pre>
                                                                                <pre>           <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Right ascension (Degrees)&quot;</span></pre>
                                                                                <pre>           <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Declination (Degrees)&quot;</span></pre>
                                                                                <pre>           <span class="c1"># Creation of the arrows of each star representing their proper motions. The color is chosen too.</span></pre>
                                                                                <pre>           <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span></pre>
                                                                                <pre>           <span class="n">p</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">Arrow</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="n">VeeHead</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y_start</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x_end</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y_end</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span></pre>
                                                        
                                                                        <pre>           <span class="n">save_plot</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;gaia&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>  <span class="c1"># open a browser</span></pre>
                                                                        <pre>           <span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># The function above is called to obtain the wanted graph</span></pre>
                                                                        <pre>       <span class="n">p</span> <span class="o">=</span> <span class="n">radvel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">max_ra</span><span class="p">,</span> <span class="n">min_ra</span><span class="p">,</span> <span class="n">max_de</span><span class="p">,</span> <span class="n">min_de</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Save the results</span></pre>
                                                                        <pre>       <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_stars_displayed</span></pre>
                                                                        <pre>       <span class="n">my_file</span> <span class="o">=</span> <span class="n">data</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="s2">&quot;my_results.txt&quot;</span><span class="p">)</span></pre>
                                                                        <pre>       <span class="n">my_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">))</span></pre></pre>
                                                                        <pre>       <span class="n">my_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></pre>
                                                    </code></div>
                                                        </div>
                                                    <h5 class="text-left mt-3">1.2 - Gaia_pm.json</h5>
                                                    <p class="text">In addition to the python file, we must create the json file to automatically generate the form in DEAVI.</p>
                                                    <div class="highlight-json notranslate text-left">
                                                        <div class="highlight p-4">
                                                            <code>
                                                            <pre><span class="p">{</span><span class="nt">&quot;algorithm&quot;</span><span class="p">:{</span></pre>
                                                            <pre>   <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Gaia_PM&quot;</span><span class="p">,</span></pre>
                                                            <pre>   <span class="nt">&quot;view_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Gaia Data with their Proper Motions (PM)&quot;</span><span class="p">,</span></pre>
                                                            <pre>   <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;h3&gt;Gaia Data with PM&lt;/h3&gt;&lt;p&gt;An representation of Gaia data with the proper motions&lt;/p&gt;&quot;</span><span class="p">,</span></pre>
                                                            <pre>   <span class="nt">&quot;input&quot;</span><span class="p">:{</span></pre>
                                                                <pre>       <span class="nt">&quot;input_1&quot;</span><span class="p">:{</span></pre>
                                                                    <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;gaia_file&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Gaia VOTable&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;gaia_table&quot;</span></pre>
                                                                <pre>       <span class="p">},</span></pre>
                                                                <pre>       <span class="nt">&quot;input_2&quot;</span><span class="p">:{</span></pre>
                                                                    <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;number_stars_displayed&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Number of stars&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span></pre>
                                                                <pre>       <span class="p">}</span></pre>
                                                            <pre>   <span class="p">}</span></pre>
                                                            <pre><span class="p">}}</span></pre>
                                                            </code>
                                                        </div>
                                                    </div>
                                            </div>
                                            <div class="tab-pane fade" id="nav-HRD" role="tabpanel" aria-labelledby="nav-HRD-tab">
                                                    <h3 class="text-left mt-3"><b>2 - Wien’s Law and Hertzsprung-Russell Diagram (HRD)</b></h3>
                                                    <p class="text">By slightly modifying the previous algorithm, we can use other characteristics. In this case, we have plotted the Wien’s law and the HDR in two independent figures.</p>
                                                    <h5 class="text-left">2.1 - Wien_HDR.py</h5>
                                                    <div class="highlight-python notranslate text-left">
                                                        <div class="highlight p-4">
                                                            <code>
                                                        
                                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                                        <pre><span class="sd">Copyright (C) 2016-2020 Quasar Science Resources, S.L.</span></pre>
                                                        
                                                        <pre><span class="sd">This file is part of DEAVI.</span></pre>
                                                        
                                                        <pre><span class="sd">DEAVI is free software: you can redistribute it and/or modify</span></pre>
                                                        <pre><span class="sd">it under the terms of the GNU General Public License as published by</span></pre>
                                                        <pre><span class="sd">the Free Software Foundation, either version 3 of the License, or</span></pre>
                                                        <pre><span class="sd">(at your option) any later version.</span></pre>
                                                        
                                                        <pre><span class="sd">DEAVI is distributed in the hope that it will be useful,</span></pre>
                                                        <pre><span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span></pre>
                                                        <pre><span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></pre>
                                                        <pre><span class="sd">GNU General Public License for more details.</span></pre>
                                                        
                                                        <pre><span class="sd">You should have received a copy of the GNU General Public License</span></pre>
                                                        <pre><span class="sd">along with DEAVI.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></pre>
                                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                                        
                                                        <pre><span class="sd">Example 2: Wien&#39;s Law and Hertzsprung-Russell Diagram (HRD). The input file is a VOTable</span></pre>
                                                        <pre><span class="sd">from the Gaia Archive</span></pre>
                                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                                        
                                                        <pre><span class="c1"># Import the necessary modules</span></pre>
                                                        <pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span></pre>
                                                        
                                                        <pre><span class="kn">from</span> <span class="nn">astropy.io.votable</span> <span class="kn">import</span> <span class="n">parse</span></pre>
                                                        <pre><span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span></pre>
                                                        
                                                        <pre><span class="kn">from</span> <span class="nn">avi.utils.plotter</span> <span class="kn">import</span> <span class="n">save_plot</span></pre>
                                                        
                                                        <pre><span class="k">class</span> <span class="nc">Wien_HDR</span><span class="p">:</span></pre>
                                                                <pre>   <span class="c1"># Initialize the Gaia table</span></pre>
                                                                <pre>   <span class="n">gaia_table</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                                                        
                                                                <pre>   <span class="c1"># Starts</span></pre>
                                                                <pre>   <span class="n">number_stars_displayed</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
                                                                <pre>   <span class="n">proportional_size</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span></pre>
                                                        
                                                                <pre>   <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">id</span><span class="p">):</span></pre>
                                                                        <pre>       <span class="c1">## Gaia VOTABLE</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Extract the information from VOTable file</span></pre>
                                                                        <pre>       <span class="n">gaia</span> <span class="o">=</span><span class="n">parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaia_table</span><span class="p">)</span></pre>
                                                                        <pre>       <span class="n">gaia_list</span> <span class="o">=</span> <span class="n">gaia</span><span class="o">.</span><span class="n">get_first_table</span><span class="p">()</span><span class="o">.</span><span class="n">array</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Parallax obtained from gaia from the different stars changing units</span></pre>
                                                                        <pre>       <span class="c1"># from mas to arcseconds</span></pre>
                                                                        <pre>       <span class="n">par</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;parallax&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Selection a smaller number of stars (number_stars_displayed)</span></pre>
                                                                        <pre>       <span class="n">paralf</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_stars_displayed</span><span class="p">]</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Get the coordinates in the cluster</span></pre>
                                                                        <pre>       <span class="c1"># https://gea.esac.esa.int/archive/documentation/GDR2/Gaia_archive/chap_datamodel/sec_dm_main_tables/ssec_dm_gaia_source.html</span></pre>
                                                                        <pre>       <span class="c1"># Declination (double, Angle[deg])</span></pre>
                                                                        <pre>       <span class="n">dec_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span></pre>
                                                                        <pre>       <span class="c1"># Right ascension (double, Angle[deg])</span></pre>
                                                                        <pre>       <span class="n">ra_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span></pre>
                                                                        <pre>       <span class="c1"># Stellar radius (float, Length &amp; Distance[Solar Radius])</span></pre>
                                                                        <pre>       <span class="n">radiof</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;radius_val&#39;</span><span class="p">]</span></pre>
                                                                        <pre>       <span class="c1"># Stellar effective temperature (float, Temperature[K])</span></pre>
                                                                        <pre>       <span class="n">temperature</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;teff_val&#39;</span><span class="p">]</span></pre>
                                                                        <pre>       <span class="c1"># stellar luminosity (float, Luminosity[Solar Luminosity])</span></pre>
                                                                        <pre>       <span class="n">luminosity</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;lum_val&#39;</span><span class="p">]</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Creation of an array that will contain only  the number of the rows of</span></pre>
                                                                        <pre>       <span class="c1"># stars with a known T, radio and luminosity</span></pre>
                                                                        <pre>       <span class="n">starts_with_T</span><span class="o">=</span><span class="p">[]</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Get index of the array with values of temperature, radio and luminosity</span></pre>
                                                                        <pre>       <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paralf</span><span class="p">)):</span></pre>
                                                                            <pre>          <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">temperature</span><span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">radiof</span> <span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">luminosity</span> <span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">):</span></pre>
                                                                            <pre>              <span class="n">starts_with_T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># We initialize the arrays necessary for the subsequent analysis.</span></pre>
                                                                        <pre>       <span class="n">dec_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">))</span></pre>
                                                                        <pre>       <span class="n">ra_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">))</span></pre>
                                                                        <pre>       <span class="n">temperature_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">))</span></pre>
                                                                        <pre>       <span class="n">radiof_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">))</span></pre>
                                                                        <pre>       <span class="n">luminosity_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">))</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Function that fills the empty vectors with the real data from gaia,</span></pre>
                                                                        <pre>       <span class="c1"># including only the stars with a known T</span></pre>
                                                                        <pre>       <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">)):</span></pre>
                                                                                <pre>           <span class="n">dec_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dec_colf</span><span class="p">[</span><span class="n">starts_with_T</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                                                <pre>           <span class="n">ra_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ra_colf</span><span class="p">[</span><span class="n">starts_with_T</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                                                <pre>           <span class="n">temperature_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">temperature</span><span class="p">[</span><span class="n">starts_with_T</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                                                <pre>           <span class="n">radiof_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">radiof</span><span class="p">[</span><span class="n">starts_with_T</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                                                <pre>           <span class="n">luminosity_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">luminosity</span><span class="p">[</span><span class="n">starts_with_T</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                        
                                                        
                                                                        <pre>       <span class="c1"># Definition of the variables that will be used to plot the coordinates</span></pre>
                                                                        <pre>       <span class="c1"># of the stars in 2D (right ascension and declination in degrees)</span></pre>
                                                                        <pre>       <span class="n">x</span> <span class="o">=</span> <span class="n">ra_colf_new</span></pre>
                                                                        <pre>       <span class="n">y</span> <span class="o">=</span> <span class="n">dec_colf_new</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># In order to define the figure, we need some auxiliary values</span></pre>
                                                        
                                                                        <pre>       <span class="n">max_ra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ra_colf_new</span><span class="p">)</span><span class="o">+</span><span class="mf">0.25</span></pre>
                                                                        <pre>       <span class="n">min_ra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ra_colf_new</span><span class="p">)</span><span class="o">-</span><span class="mf">0.25</span></pre>
                                                                        <pre>       <span class="n">max_de</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dec_colf_new</span><span class="p">)</span><span class="o">+</span><span class="mf">0.25</span></pre>
                                                                        <pre>       <span class="n">min_de</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dec_colf_new</span><span class="p">)</span><span class="o">-</span><span class="mf">0.25</span></pre>
                                                        
                                                                        <pre>       <span class="n">luminosity_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">luminosity_new</span><span class="p">)</span></pre>
                                                                        <pre>       <span class="n">min_T</span> <span class="o">=</span> <span class="n">temperature_new</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.1</span></pre>
                                                                        <pre>       <span class="n">max_T</span> <span class="o">=</span> <span class="n">temperature_new</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span></pre>
                                                                        <pre>       <span class="n">min_L</span> <span class="o">=</span> <span class="n">luminosity_new</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.1</span></pre>
                                                                        <pre>       <span class="n">max_L</span> <span class="o">=</span> <span class="n">luminosity_new</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span></pre>
                                                        
                                                                        <pre>       <span class="k">def</span> <span class="nf">wien_law</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">temperature_new</span><span class="p">,</span> <span class="n">min_ra</span><span class="p">,</span> <span class="n">max_ra</span><span class="p">,</span> <span class="n">min_de</span><span class="p">,</span> <span class="n">max_de</span><span class="p">,</span> <span class="n">radiof_new</span><span class="p">):</span></pre>
                                                                            <pre>           <span class="n">p</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Wien’s Law with a proportional radius size&quot;</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="n">max_ra</span><span class="p">,</span> <span class="n">min_ra</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="n">min_de</span><span class="p">,</span><span class="n">max_de</span><span class="p">))</span></pre>
                                                                            <pre>           <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Right ascension (Degrees)&quot;</span></pre>
                                                                            <pre>           <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Declination (Degrees)&quot;</span></pre>
                                                        
                                                                            <pre>           <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">)):</span></pre>
                                                                                    <pre>               <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proportional_size</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span></pre>
                                                                                    <pre>                   <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="mi">45</span><span class="p">)</span></pre>
                                                                                    <pre>               <span class="k">else</span><span class="p">:</span></pre>
                                                                                    <pre>                   <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.008</span></pre>
                                                                                    <pre>               <span class="c1"># Class O, onized and neutral helium, weakened hydrogen --&gt; blueish</span></pre>
                                                                                    <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">31000</span><span class="p">:</span></pre>
                                                                                    <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ADD8E6&quot;</span><span class="p">)</span></pre>
                                                                                    <pre>               <span class="c1"># Class B, Neutral helium, stronger hydrogen --&gt; Blue-white</span></pre>
                                                                                    <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">31000</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">9750</span><span class="p">:</span></pre>
                                                                                    <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#e6ffff&quot;</span><span class="p">)</span></pre>
                                                                                    <pre>               <span class="c1"># Class A, Stronger hydrogen, ionized metals --&gt; White</span></pre>
                                                                                    <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">9750</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">7100</span><span class="p">:</span></pre>
                                                                                    <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">)</span></pre>
                                                                                    <pre>               <span class="c1"># Class F, Weaker hydrogen, ionized metals --&gt; Yellow - White</span></pre>
                                                                                    <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">7100</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5950</span><span class="p">:</span></pre>
                                                                                    <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffffcc&quot;</span><span class="p">)</span></pre>
                                                                                    <pre>               <span class="c1"># Class G Weak hydrogen, ionized and neutral metals --&gt; Yellowish</span></pre>
                                                                                    <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5950</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5250</span><span class="p">:</span></pre>
                                                                                    <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffff66&quot;</span><span class="p">)</span></pre>
                                                                                    <pre>               <span class="c1"># Class K, Weak hydrogen, neutral metals --&gt; Orange</span></pre>
                                                                                    <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5250</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3950</span><span class="p">:</span></pre>
                                                                                    <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ff9900&quot;</span><span class="p">)</span></pre>
                                                                                    <pre>               <span class="c1"># Class M, Little or no hydrogen, neutral metals, molecules --&gt; Reddish</span></pre>
                                                                                    <pre>               <span class="k">if</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3950</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span></pre>
                                                                                    <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ff9980&quot;</span><span class="p">)</span></pre>
                                                        
                                                                            <pre>           <span class="n">save_plot</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;stars_temperature&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></pre>
                                                                            <pre>           <span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="k">def</span> <span class="nf">hertzsprung_russell_diagram</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">,</span> <span class="n">luminosity_new</span><span class="p">,</span> <span class="n">radiof_new</span><span class="p">):</span></pre>
                                                        
                                                                            <pre>           <span class="n">p</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Hertzsprung-Russell Diagram (HRD)&quot;</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="n">max_T</span><span class="p">,</span> <span class="n">min_T</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="n">min_L</span><span class="p">,</span><span class="n">max_L</span><span class="p">))</span></pre>
                                                                            <pre>           <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Surface Temperature (k)&quot;</span></pre>
                                                                            <pre>           <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Luminosity (Solar Luminosity)&quot;</span></pre>
                                                        
                                                        
                                                                            <pre>           <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">)):</span></pre>
                                                                            <pre>               <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span></pre>
                                                        
                                                                            <pre>               <span class="c1"># Class O, onized and neutral helium, weakened hydrogen --&gt; blueish</span></pre>
                                                                            <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">31000</span><span class="p">:</span></pre>
                                                                            <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ADD8E6&quot;</span><span class="p">)</span></pre>
                                                                            <pre>               <span class="c1"># Class B, Neutral helium, stronger hydrogen --&gt; Blue-white</span></pre>
                                                                            <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">31000</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">9750</span><span class="p">:</span></pre>
                                                                            <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#e6ffff&quot;</span><span class="p">)</span></pre>
                                                                            <pre>               <span class="c1"># Class A, Stronger hydrogen, ionized metals --&gt; White</span></pre>
                                                                            <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">9750</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">7100</span><span class="p">:</span></pre>
                                                                            <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">)</span></pre>
                                                                            <pre>               <span class="c1"># Class F, Weaker hydrogen, ionized metals --&gt; Yellow - White</span></pre>
                                                                            <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">7100</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5950</span><span class="p">:</span></pre>
                                                                            <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffffcc&quot;</span><span class="p">)</span></pre>
                                                                            <pre>               <span class="c1"># Class G, Weak hydrogen, ionized and neutral metals --&gt; Yellowish</span></pre>
                                                                            <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5950</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5250</span><span class="p">:</span></pre>
                                                                            <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffff66&quot;</span><span class="p">)</span></pre>
                                                                            <pre>               <span class="c1"># Class K, Weak hydrogen, neutral metals --&gt; Orange</span></pre>
                                                                            <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5250</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3950</span><span class="p">:</span></pre>
                                                                            <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ff9900&quot;</span><span class="p">)</span></pre>
                                                                            <pre>               <span class="c1"># Class M, Little or no hydrogen, neutral metals, molecules --&gt; Reddish</span></pre>
                                                                            <pre>               <span class="k">if</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3950</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span></pre>
                                                                            <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ff9980&quot;</span><span class="p">)</span></pre>
                                                        
                                                                            <pre>           <span class="n">save_plot</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;stars_temperature&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></pre>
                                                                            <pre>           <span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="n">p1</span> <span class="o">=</span> <span class="n">wien_law</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">temperature_new</span><span class="p">,</span> <span class="n">min_ra</span><span class="p">,</span> <span class="n">max_ra</span><span class="p">,</span> <span class="n">min_de</span><span class="p">,</span> <span class="n">max_de</span><span class="p">,</span> <span class="n">radiof_new</span><span class="p">)</span></pre>
                                                                        <pre>       <span class="n">p2</span> <span class="o">=</span> <span class="n">hertzsprung_russell_diagram</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">,</span> <span class="n">luminosity_new</span><span class="p">,</span> <span class="n">radiof_new</span><span class="p">)</span></pre>
                                                                </code>
                                                            </div>
                                                        </div>
                    
                    
                    
                                                    <h5 class="text-left mt-4">2.2 - Wien_HDR.json</h5>
                                                    <div class="highlight-json notranslate text-left">
                                                        <div class="highlight p-4">
                                                            <code>
                                                        <pre><span class="p">{</span><span class="nt">&quot;algorithm&quot;</span><span class="p">:{</span></pre>
                                                        <pre>   <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Wien_HDR&quot;</span><span class="p">,</span></pre>
                                                        <pre>   <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Wien Law and Hertzsprung-Russell Diagram (HRD)&quot;</span><span class="p">,</span></pre>
                                                        <pre>   <span class="nt">&quot;input&quot;</span><span class="p">:{</span></pre>
                                                                <pre>       <span class="nt">&quot;input_1&quot;</span><span class="p">:{</span></pre>
                                                                        <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;gaia_table&quot;</span><span class="p">,</span></pre>
                                                                        <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Gaia VOTable&quot;</span><span class="p">,</span></pre>
                                                                        <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;gaia_table&quot;</span></pre>
                                                                <pre>       <span class="p">},</span></pre>
                                                                <pre>       <span class="nt">&quot;input_2&quot;</span><span class="p">:{</span></pre>
                                                                    <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;proportional_size&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Size proportional to the radious (y/n)&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;string&quot;</span></pre>
                                                                <pre>       <span class="p">},</span></pre>
                                                                <pre>       <span class="nt">&quot;input_3&quot;</span><span class="p">:{</span></pre>
                                                                    <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;number_stars_displayed&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Number of the stars&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span></pre>
                                                                <pre>       <span class="p">}</span></pre>
                                                        <pre>   <span class="p">}</span></pre>
                                                    <pre><span class="p">}}</span></pre>
                                                    </code>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tab-pane fade" id="nav-Gaia-Herschel" role="tabpanel" aria-labelledby="nav-Gaia-Herschel-tab">
                                                    <h3 class="text-left mt-3"><b>3 - Plotting Gaia and Herschel data simultaneously</b></h3>
                                                    <p class="text">The last example shows how use Herschel data. In this case, we modify the first example so that the Gaia and Herschel data are displayed simultaneously.</p>
                                                    <h5 class="text-left">3.1 - Gaia_Herschel.py</h5>
                                                    <div class="highlight-python notranslate text-left">
                                                        <div class="highlight p-4">
                                                            <code>
                                                        
                                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                                        <pre><span class="sd">Copyright (C) 2016-2020 Quasar Science Resources, S.L.</span></pre>
                                                        
                                                        <pre><span class="sd">This file is part of DEAVI.</span></pre>
                                                        
                                                        <pre><span class="sd">DEAVI is free software: you can redistribute it and/or modify</span></pre>
                                                        <pre><span class="sd">it under the terms of the GNU General Public License as published by</span></pre>
                                                        <pre><span class="sd">the Free Software Foundation, either version 3 of the License, or</span></pre>
                                                        <pre><span class="sd">(at your option) any later version.</span></pre>
                                                        
                                                        <pre><span class="sd">DEAVI is distributed in the hope that it will be useful,</span></pre>
                                                        <pre><span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span></pre>
                                                        <pre><span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></pre>
                                                        <pre><span class="sd">GNU General Public License for more details.</span></pre>
                                                        
                                                        <pre><span class="sd">You should have received a copy of the GNU General Public License</span></pre>
                                                        <pre><span class="sd">along with DEAVI.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></pre>
                                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                                        
                                                        <pre><span class="sd">Example 3: This algorithm plots the positions of a certain number of stars in a</span></pre>
                                                        <pre><span class="sd">cluster together with their respective proper motions. Also, it plot the Herschel</span></pre>
                                                        <pre><span class="sd">image in the same coordinates.</span></pre>
                                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                                        <pre><span class="c1"># Import the necessary modules</span></pre>
                                                        <pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span></pre>
                                                        
                                                        <pre><span class="kn">from</span> <span class="nn">astropy.io.votable</span> <span class="kn">import</span> <span class="n">parse</span></pre>
                                                        <pre><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span></pre>
                                                        <pre><span class="kn">from</span> <span class="nn">astropy.wcs</span> <span class="kn">import</span> <span class="n">WCS</span></pre>
                                                        <pre><span class="kn">from</span> <span class="nn">astropy.nddata</span> <span class="kn">import</span> <span class="n">block_reduce</span></pre>
                                                        
                                                        <pre><span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span></pre>
                                                        <pre><span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">Arrow</span><span class="p">,</span> <span class="n">VeeHead</span><span class="p">,</span> <span class="n">LogColorMapper</span><span class="p">,</span> <span class="n">ColorBar</span><span class="p">,</span> <span class="n">LogTicker</span></pre>
                                                        
                                                        <pre><span class="kn">from</span> <span class="nn">avi.utils.plotter</span> <span class="kn">import</span> <span class="n">save_plot</span></pre>
                                                        <pre><span class="kn">from</span> <span class="nn">avi.utils.data.data_file</span> <span class="kn">import</span> <span class="n">data_file</span> <span class="k">as</span> <span class="n">data</span></pre>
                                                        
                                                        
                                                        <pre><span class="k">class</span> <span class="nc">Gaia_Herschel</span><span class="p">:</span></pre>
                                                                <pre>   <span class="c1"># Initialize the Gaia and Herschel tables</span></pre>
                                                                <pre>   <span class="n">gaia_table</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                                                                <pre>   <span class="n">hsa_table</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                                                        
                                                                <pre>   <span class="c1"># Starts</span></pre>
                                                                <pre>   <span class="n">number_stars_displayed</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
                                                        
                                                                <pre>   <span class="c1"># Downsample a data array by applying a function to local blocks.</span></pre>
                                                                <pre>   <span class="c1"># See http://docs.astropy.org/en/stable/api/astropy.nddata.block_reduce.html</span></pre>
                                                                <pre>   <span class="n">size_block</span> <span class="o">=</span> <span class="mi">1</span></pre>
                                                        
                                                        
                                                                <pre>   <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">id</span><span class="p">):</span></pre>
                                                                        <pre>       <span class="c1">## Herschel FITS</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Load the FITS file with the world coordinate system</span></pre>
                                                                        <pre>       <span class="n">herschel</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hsa_table</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># FITS files have some extensions, we separate them</span></pre>
                                                                        <pre>       <span class="n">head</span> <span class="o">=</span> <span class="n">herschel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span></pre>
                                                                        <pre>       <span class="c1"># The information is located in the extension 1</span></pre>
                                                                        <pre>       <span class="n">im</span> <span class="o">=</span> <span class="n">herschel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># The World Coordinate System information is located in the header so</span></pre>
                                                                        <pre>       <span class="n">w</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">head</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># In order to define the figure, we need to create two ndarrays</span></pre>
                                                                        <pre>       <span class="n">xpx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span></pre>
                                                                        <pre>       <span class="n">ypx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Now, we create the grid using the previous ndarrays</span></pre>
                                                                        <pre>       <span class="n">xlist</span><span class="p">,</span> <span class="n">ylist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xpx</span><span class="p">,</span><span class="n">ypx</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># We want a plot in WCS so we need to convert pixels to WCS</span></pre>
                                                                        <pre>       <span class="n">ralist</span><span class="p">,</span> <span class="n">declist</span><span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_pix2world</span><span class="p">(</span><span class="n">xlist</span><span class="p">,</span> <span class="n">ylist</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1">## Gaia VOTABLE</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Extract the information from VOTABLE file</span></pre>
                                                                        <pre>       <span class="n">gaia</span> <span class="o">=</span><span class="n">parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaia_table</span><span class="p">)</span></pre>
                                                                        <pre>       <span class="n">gaia_list</span> <span class="o">=</span> <span class="n">gaia</span><span class="o">.</span><span class="n">get_first_table</span><span class="p">()</span><span class="o">.</span><span class="n">array</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Parallax obtained from gaia from the different stars changing units</span></pre>
                                                                        <pre>       <span class="c1"># from mas to arcseconds</span></pre>
                                                                        <pre>       <span class="n">par</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;parallax&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Selection a smaller number of stars (number_stars_displayed)</span></pre>
                                                                        <pre>       <span class="n">paralf</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_stars_displayed</span><span class="p">]</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Get the coordinates and proper motions of the stars in the cluster</span></pre>
                                                                        <pre>       <span class="c1"># https://gea.esac.esa.int/archive/documentation/GDR2/Gaia_archive/chap_datamodel/sec_dm_main_tables/ssec_dm_gaia_source.html</span></pre>
                                                                        <pre>       <span class="c1"># Proper motion in declination direction (double, Angular Velocity[mas/year] )</span></pre>
                                                                        <pre>       <span class="n">propermot_de_sf</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;pmdec&#39;</span><span class="p">]</span></pre>
                                                                        <pre>       <span class="c1"># Proper motion in right ascension direction (double, Angular Velocity[mas/year])</span></pre>
                                                                        <pre>       <span class="n">propermot_ra_sf</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;pmra&#39;</span><span class="p">]</span></pre>
                                                                        <pre>       <span class="c1"># Declination (double, Angle[deg])</span></pre>
                                                                        <pre>       <span class="n">dec_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span></pre>
                                                                        <pre>       <span class="c1"># Right ascension (double, Angle[deg])</span></pre>
                                                                        <pre>       <span class="n">ra_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span></pre>
                                                                        <pre>       <span class="c1"># Stellar radius (float, Length &amp; Distance[Solar Radius])</span></pre>
                                                                        <pre>       <span class="n">radiof</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;radius_val&#39;</span><span class="p">]</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Creation of an array that will contain only  the number of the rows of</span></pre>
                                                                        <pre>       <span class="c1"># stars with a known proper motion (DR2)</span></pre>
                                                                        <pre>       <span class="n">starts_with_pm</span><span class="o">=</span><span class="p">[]</span></pre>
                                                        
                                                                        <pre>       <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paralf</span><span class="p">)):</span></pre>
                                                                        <pre>           <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">propermot_de_sf</span><span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">:</span></pre>
                                                                                <pre>               <span class="n">starts_with_pm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># We initialize the arrays necessary for the subsequent analysis.</span></pre>
                                                                        <pre>       <span class="n">propermot_de_sf_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                                        <pre>       <span class="n">propermot_ra_sf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                                        <pre>       <span class="n">dec_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                                        <pre>       <span class="n">ra_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                                        <pre>       <span class="n">paral_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                                        <pre>       <span class="n">radiof_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Function that fills the empty vectors with the real data from gaia,</span></pre>
                                                                        <pre>       <span class="c1"># including only the stars with a known proper motion</span></pre>
                                                                        <pre>       <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">)):</span></pre>
                                                                            <pre>           <span class="c1"># The proper motions are given in arcseconds per year so they are</span></pre>
                                                                            <pre>           <span class="c1"># divided by a factor of 3600 to change the units to degrees</span></pre>
                                                                            <pre>           <span class="n">propermot_de_sf_new</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="n">propermot_de_sf</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">/</span><span class="mi">3600</span></pre>
                                                                            <pre>           <span class="n">propermot_ra_sf_new</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="n">propermot_ra_sf</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">/</span><span class="mi">3600</span></pre>
                                                                            <pre>           <span class="n">dec_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dec_colf</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                                            <pre>           <span class="n">ra_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ra_colf</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                                            <pre>           <span class="n">paral_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">paralf</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                                            <pre>           <span class="n">radiof_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">radiof</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                        
                                                                        <pre>       <span class="c1">#Definition of the variables that will be used to plot the coordinates</span></pre>
                                                                        <pre>       <span class="c1"># of the stars in 2D (right ascension and declination in degrees)</span></pre>
                                                                        <pre>       <span class="n">x</span> <span class="o">=</span> <span class="n">ra_colf_new</span></pre>
                                                                        <pre>       <span class="n">y</span> <span class="o">=</span> <span class="n">dec_colf_new</span></pre>
                                                        
                                                        
                                                                        <pre>       <span class="c1"># Definition of the variables that will be used to plot the proper</span></pre>
                                                                        <pre>       <span class="c1"># motions of the stars in 2D in degrees per year (they are multiplied by</span></pre>
                                                                        <pre>       <span class="c1"># a factor of 10 to make the proportions more visually understandable in</span></pre>
                                                                        <pre>       <span class="c1"># the plot)</span></pre>
                                                        
                                                                        <pre>       <span class="n">u</span> <span class="o">=</span> <span class="n">propermot_ra_sf_new</span><span class="o">*</span><span class="mi">10</span></pre>
                                                                        <pre>       <span class="n">v</span> <span class="o">=</span> <span class="n">propermot_de_sf_new</span><span class="o">*</span><span class="mi">10</span></pre>
                                                        
                                                                        <pre>       <span class="c1">## Herschel&#39;s plot</span></pre>
                                                                        <pre>       <span class="c1"># Reduce the quality of the image to display</span></pre>
                                                                        <pre>       <span class="n">small</span> <span class="o">=</span> <span class="n">block_reduce</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_block</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># When the mouse is moving through the plot, the coordinates will appear</span></pre>
                                                                        <pre>       <span class="n">TOOLTIPS</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;(RA,DEC)&quot;</span><span class="p">,</span><span class="s2">&quot;($x,$y)&quot;</span><span class="p">),(</span><span class="s2">&quot;Valor&quot;</span><span class="p">,</span><span class="s2">&quot;@image&quot;</span><span class="p">)]</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Creation of the image</span></pre>
                                                                        <pre>       <span class="n">main_plot</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="n">ralist</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">ralist</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="n">declist</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">declist</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="n">tooltips</span><span class="o">=</span><span class="n">TOOLTIPS</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="n">color_mapper</span> <span class="o">=</span> <span class="n">LogColorMapper</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Viridis256&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">im</span><span class="p">),</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">im</span><span class="p">))</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Add to the plot the Herschel image</span></pre>
                                                                        <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="p">[</span><span class="n">small</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">ralist</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">declist</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">dw</span><span class="o">=</span><span class="p">(</span><span class="n">ralist</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">ralist</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">dh</span><span class="o">=</span><span class="p">(</span><span class="n">declist</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">declist</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">color_mapper</span><span class="o">=</span><span class="n">color_mapper</span><span class="p">)</span></pre>
                                                                        <pre>       <span class="n">color_bar</span> <span class="o">=</span> <span class="n">ColorBar</span><span class="p">(</span><span class="n">color_mapper</span><span class="o">=</span><span class="n">color_mapper</span><span class="p">,</span> <span class="n">ticker</span><span class="o">=</span><span class="n">LogTicker</span><span class="p">(),</span> <span class="n">label_standoff</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">border_line_color</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span></pre>
                                                                        <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">color_bar</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Creation of the points that represent the stars and their color</span></pre>
                                                                        <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#FFD700&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;#FF8C00&quot;</span> <span class="p">,</span><span class="n">radius</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">)</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Creation of the arrows of each star representing their proper motions.</span></pre>
                                                                        <pre>       <span class="c1"># The color is chosen too</span></pre>
                                                        
                                                                        <pre>       <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span></pre>
                                                                        <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">Arrow</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="n">VeeHead</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">y_start</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">x_end</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">y_end</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">m</span><span class="p">]))</span></pre>
                                                        
                                                                        <pre>       <span class="c1"># Title of the axis and units</span></pre>
                                                                        <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span><span class="o">=</span><span class="s2">&quot;Right Ascension (Degrees)&quot;</span></pre>
                                                                        <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span><span class="o">=</span><span class="s2">&quot;Declination (Degrees)&quot;</span></pre>
                                                        
                                                                        <pre>       <span class="n">show</span><span class="p">(</span><span class="n">main_plot</span><span class="p">)</span></pre>
                                                                        <pre>       <span class="n">save_plot</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;Gaia y Herschel&quot;</span><span class="p">,</span> <span class="n">main_plot</span><span class="p">)</span> <span class="c1"># open a browser</span></pre>
                                                            </code>
                                                        </div>
                                                        </div>
                    
                    
                    
                                                    <h5 class="text-left mt-4">3.2 - Gaia_Herschel.json</h5>
                                                    <div class="highlight-json notranslate text-left">
                                                        <div class="highlight p-4">
                                                            <code>
                                                        <pre><span class="p">{</span><span class="nt">&quot;algorithm&quot;</span><span class="p">:{</span></pre>
                                                        <pre>   <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Gaia_Herschel&quot;</span><span class="p">,</span></pre>
                                                        <pre>   <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Plot Gaia and Herschel data&quot;</span><span class="p">,</span></pre>
                                                        <pre>   <span class="nt">&quot;input&quot;</span><span class="p">:{</span></pre>
                                                            <pre>       <span class="nt">&quot;input_1&quot;</span><span class="p">:{</span></pre>
                                                                <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;gaia_table&quot;</span><span class="p">,</span></pre>
                                                                <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Gaia VOTable&quot;</span><span class="p">,</span></pre>
                                                                <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;gaia_table&quot;</span></pre>
                                                            <pre>       <span class="p">},</span></pre>
                                                            <pre>       <span class="nt">&quot;input_2&quot;</span><span class="p">:{</span></pre>
                                                                    <pre            ><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;hsa_table&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Herschel FITS&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;hsa_table&quot;</span></pre>
                                                            <pre>       <span class="p">},</span></pre>
                                                            <pre>       <span class="nt">&quot;input_3&quot;</span><span class="p">:{</span></pre>
                                                                    <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;number_stars_displayed&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Number of the stars&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span></pre>
                                                            <pre>       <span class="p">},</span></pre>
                                                            <pre>       <span class="nt">&quot;input_4&quot;</span><span class="p">:{</span></pre>
                                                                    <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;size_block&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Size of the block&quot;</span><span class="p">,</span></pre>
                                                                    <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;integer&quot;</span></pre>
                                                            <pre>       <span class="p">}</span></pre>
                                                
                                                    <pre>   <span class="p">}</span></pre>
                                                    <pre><span class="p">}}</span></pre>
                                                </code>
                                                </div>
                                                </div>
                                            </div>
                                            <div class="tab-pane fade" id="nav-query-gaia" role="tabpanel" aria-labelledby="nav-query-gaia-tab">
                                                <h3 class="text-left mt-3"><b>4 - How to query the Gaia Archive</b></h3>
                                                <ol>
                                                    <li class="li_guide text-left">Go to the Gaia section in Queries:</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_menu.png' %}" style="width: 20%; max-width: 300px" alt="image of Menu Gaia Selected"><br><br>
                                                    <li class="li_guide text-left">Configure the query according to your preferences.</li>
                                                    <li class="li_guide text-left">Click on “Submit”</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_submit.png' %}" alt="image of Gaia Query"><br><br>
                                                </ol>
                                            </div>
                                            <div class="tab-pane fade" id="nav-query-hsa" role="tabpanel" aria-labelledby="nav-query-hsa-tab">
                                                <h3 class="text-left mt-3"><b>5 - How to query the Herschel Archive</b></h3>
                                                <ol>
                                                    <li class="li_guide text-left">Go to the Herschel section in Queries:</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/herschel_menu.png' %}" style="width: 20%; max-width: 300px" alt="image of Menu Gaia Selected"><br><br>
                                                    <li class="li_guide text-left">Configure the query according to your preferences.</li>
                                                    <li class="li_guide text-left">Click on “Submit”</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/herschel_submit.png' %}" alt="image of Gaia Query"><br><br>
                                                </ol>
                                            </div>
                                            <div class="tab-pane fade" id="nav-queries-status" role="tabpanel" aria-labelledby="nav-queries-status-tab">
                                                <h3 class="text-left mt-3"><b>6 - How to check the queries status</b></h3>
                                                <ol>
                                                    <li class="li_guide text-left">Go to the Status section in Queries.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/query_status_section.png' %}" alt="image of Query Status"><br><br>
                                                </ol>
                                            </div>
                                            <div class="tab-pane fade" id="nav-use-algorithm-gaia" role="tabpanel" aria-labelledby="nav-use-algorithm-gaia-tab">
                                                <h3 class="text-left mt-3"><b>7 - How to use the algorithm “Gaia Data with their Proper Motions (PM)”</b></h3>
                                                <ol>
                                                    <li class="li_guide text-left">Go to the Start section in Algorithms and click on “Gaia Data with their Proper Motions (PM)”.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_pm_algorithm_1.png' %}" alt="image of Start Algorithm"><br><br>
                                                    <li class="li_guide text-left">Select an available VOTable. If none are available, click on “Launch Gaia Query” and set it according to your preferences.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_pm_algorithm_2.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                                    <li class="li_guide text-left">Enter the number of stars plotted and click on “Run”</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_pm_algorithm_3.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                                    <p class="text">After a few seconds, you will be redirected to the “Pipeline Status” page where the algorithm’s execution status will be reported.</p>
                                                    <li class="li_guide text-left">Once the execution is finished, click on the execution and you will see the figure, the results and the different options available.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_pm_algorithm_4.png' %}" alt="image of Query Status"><br><br>
                                                </ol>
                                            </div>
                                            <div class="tab-pane fade" id="nav-use-algorithm-gaia-hsa" role="tabpanel" aria-labelledby="nav-use-algorithm-gaia-hsa">
                                                <h3 class="text-left mt-3"><b>8 - How to use the algorithm “Plot Gaia and Herschel data”</b></h3>
                                                <ol>
                                                    <li class="li_guide text-left">Go to the Start section in Algorithms and click on “Plot Gaia and Herschel data”</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_1.png' %}" alt="image of Start Algorithm"><br><br>
                                                    <li class="li_guide text-left">Enter the size of the block to reduce the quality of the image. Size of the block = 1 will return an image with the highest quality.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_2.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                                    <li class="li_guide text-left">Select an available FITS. If none are available, click on “Launch Herschel Query” and set it according to your preferences.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_3.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                                    <li class="li_guide text-left">Enter the number of stars plotted.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_4.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                                    <li class="li_guide text-left">Select an available VOTable and click on “Run”. If none are available, click on “Launch Gaia Query” and set it according to your preferences.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_5.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                                    <p class="text">After a few seconds, you will be redirected to the “Pipeline Status” page where the algorithm’s execution status will be reported.</p>
                                                    <li class="li_guide text-left">Once the execution is finished, click on the execution and you will see the figure, the results and the different options available.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_6.png' %}" alt="image of Query Status"><br><br>
                                                </ol>
                                            </div>
                                            <div class="tab-pane fade" id="nav-use-algorithm-hrd" role="tabpanel" aria-labelledby="nav-use-algorithm-hrd">
                                                <h3 class="text-left mt-3"><b>9 - How to use the algorithm “Wien Law and Hertzsprung-Russell Diagram (HRD)”</b></h3>
                                                <ol>
                                                    <li class="li_guide text-left">Go to the Start section in Algorithms and click on “Wien Law and Hertzsprung-Russell Diagram (HRD)”.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/wien_algorithm_1.png' %}" alt="image of Start Algorithm"><br><br>
                                                    <li class="li_guide text-left">Enter “y” or “n” depending on whether you want the star’s radius to be proportional to the real radius.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/wien_algorithm_2.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                                    <li class="li_guide text-left">Enter the number of stars plotted.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/wien_algorithm_3.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                                    <li class="li_guide text-left">Select an available VOTable and click on “Run”. If none are available, click on “Launch Gaia Query” and set it according to your preferences.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/wien_algorithm_4.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                                    <p class="text">After a few seconds, you will be redirected to the “Pipeline Status” page where the algorithm’s execution status will be reported.</p>
                                                    <li class="li_guide text-left">Once the execution is finished, click on the execution and you will see the figure, the results and the different options available.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/wien_algorithm_5.png' %}" alt="image of Query Status"><br><br>
                                                </ol>
                                            </div>
                                            <div class="tab-pane fade" id="nav-files" role="tabpanel" aria-labelledby="nav-files">
                                                <h3 class="text-left mt-3"><b>10 - How to find my files</b></h3>
                                                <ol>
                                                    <li class="li_guide text-left">Go to the Data section and click on “File Manager”.</li>
                                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/filemanager_1.png' %}" alt="image of File Manager"><br><br>
                                                </ol>
                
                                                <ul>
                                                    <li class="li_guide text-left"><b>Sources</b>: This folder in turn contains the files obtained from Gaia and Herschel (hsa) queries.</li>
                                                    <li class="li_guide text-left"><b>Results</b>: It contains all the files generated by the algorithms as results.</li>
                                                    <li class="li_guide text-left"><b>User</b>: It contains any files uploaded by the user.</
                                                </ul>
                                            </div>
                                        </div>
                                <!-- <h3 class="text-left"><b>1 - Plotting Gaia data with their proper motions</b></h3>
                                <p class="text">This algorithm plots the positions of a certain number of stars in a cluster 
                                    together with their respective proper motions. The input file is a VOTable from the Gaia Archive.</p>
                                <h5 class="text-left">1.1 - Gaia_pm.py</h5>
                                <p class="text">The first step is to create the Python file where the algorithm is defined. In our case we called it “gaia_pm”.</p>
                                <p class="text">As usual, we have to import the necessary modules. This algorithm uses 
                                    <a class="a-link" href="https://numpy.org/" target="_blank">Numpy</a>, 
                                    <a class="a-link" href="https://www.astropy.org/" target="_blank">Astropy</a>,
                                    <a class="a-link" href="https://bokeh.pydata.org/en/latest/" target="_blank">Bokeh</a> and DEAVI libraries.</p>
                                <div class="highlight-python notranslate text-left">
                                    <div class="highlight text-left p-4">
                                    <code><p><span class="c1"># Import the necessary modules</span></p>

                                    <p><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span></p>
                                    
                                    <p><span class="kn">from</span> <span class="nn">astropy.io.votable</span> <span class="kn">import</span> <span class="n">parse</span></p>
                                    
                                    <p><span class="kn">from</span> <span class="nn">avi.utils.plotter</span> <span class="kn">import</span> <span class="n">save_plot</span></p>
                                    <p><span class="kn">from</span> <span class="nn">avi.utils.data.data_file</span> <span class="kn">import</span> <span class="n">data_file</span> <span class="k">as</span> <span class="n">data</span></p>
                                    
                                    <p><span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span></p>
                                    <p><span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">Arrow</span><span class="p">,</span> <span class="n">VeeHead</span></p></code>
                                    </div>
                                </div>
                                <p class="text">Next, we create the python class where the algorithm functions are implemented. This class will grow as we add functions. For now,</p>
                                <div class="highlight-python notranslate text-left">
                                    <div class="highlight p-4">
                                        <code><p><span class="k">class</span> <span class="nc">Gaia_PM</span><span class="p">:</span></p></code>
                                    </div>
                                </div>
                                <br>
                                <p class="text">Once the class is created, we have to define the inputs. The algorithm will plot a set of stars with their proper motions, so we will need two inputs:</p>
                                <ul>
                                    <li class="li_guide text-left">A VOTable file.</li>
                                    <li class="li_guide text-left">The number of stars.</li>
                                </ul>
                                <div class="highlight-python notranslate text-left">
                                    <div class="highlight p-4">
                                        <code><pre><span class="k">class</span> <span class="nc">Gaia_PM</span><span class="p">:</span></pre>
                                        <pre><span class="c1">  # Initialize the Gaia table</span></pre>
                                        <pre><span class="n">   gaia_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                            
                                        <pre><span class="c1">  # Starts</span></pre>
                                        <pre><span class="n">   number_stars_displayed</span> <span class="o">=</span> <span class="mf">0.0</span></pre></code>
                                    </div>
                                </div>
                                <p class="text">In the main class we have to create a “run” function that contains all the tasks to be executed.</p>
                                <div class="highlight-python notranslate text-left">
                                    <div class="highlight p-4">
                                        <code><span class="k">class</span> <span class="nc">Gaia_PM</span><span class="p">:</span>
                                        <pre><span class="c1">  # Initialize the Gaia table</span></pre>
                                        <pre><span class="n">   gaia_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                            
                                        <pre><span class="c1">  # Starts</span></pre>
                                        <pre><span class="n">   number_stars_displayed</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
                    
                                        <pre><span class="k">   def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span></pre>
                                        <pre><span class="o">   .....</span></pre>
                                        <pre><span class="o">   .....</span></pre>
                                        <pre><span class="o">   .....</span></pre></code>
                                    </div>
                                </div>
                                <ul>
                                    <li class="li_guide text-left"><b>run function:</b></li>
                                </ul>
                                <p class="text">We will start parsing the data in the VOTable file. Next, we will import the variables of interest. 
                                    For more information visit the 
                                    <a class="a-link" href="https://gea.esac.esa.int/archive/documentation/GDR2/Gaia_archive/chap_datamodel/sec_dm_main_tables/ssec_dm_gaia_source.html" target="_blank">
                                        Gaia Data Release Documnetation
                                    </a>.</p>
                                <p class="text">The last step will be to plot the values ​​and save the results. Thus,</p>
                                <div class="highlight-python notranslate text-left">
                                    <div class="highlight p-4"><code>
                                    
                                    <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                    <pre><span class="sd">Copyright (C) 2016-2020 Quasar Science Resources, S.L.</span></pre>
                                    
                                    <pre><span class="sd">This file is part of DEAVI.</span></pre>
                                   
                                    <pre><span class="sd">DEAVI is free software: you can redistribute it and/or modify</span></pre>
                                    <pre><span class="sd">it under the terms of the GNU General Public License as published by</span></pre>
                                    <pre><span class="sd">the Free Software Foundation, either version 3 of the License, or</span></pre>
                                    <pre><span class="sd">(at your option) any later version.</span></pre>
                                    
                                    <pre><span class="sd">DEAVI is distributed in the hope that it will be useful,</span></pre>
                                    <pre><span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span></pre>
                                    <pre><span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></pre>
                                    <pre><span class="sd">GNU General Public License for more details.</span></pre>
                                    
                                        <pre><span class="sd">You should have received a copy of the GNU General Public License</span></pre>
                                        <pre><span class="sd">along with DEAVI.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></pre>
                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                        
                                        <pre><span class="sd">Example 1: This algorithm plots the positions of a certain number of stars in a</span></pre>
                                        <pre><span class="sd">cluster together with their respective proper motions. The input file is a VOTable</span></pre>
                                        <pre><span class="sd">from the Gaia Archive</span></pre>
                                        <pre><span class="sd">&quot;&quot;&quot;</span></pre>
        
                                        <pre><span class="c1"># Import the necessary modules</span></pre>
    
                                        <pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span></pre>

                                        <pre><span class="kn">from</span> <span class="nn">astropy.io.votable</span> <span class="kn">import</span> <span class="n">parse</span></pre>

                                        <pre><span class="kn">from</span> <span class="nn">avi.utils.plotter</span> <span class="kn">import</span> <span class="n">save_plot</span></pre>
                                        <pre><span class="kn">from</span> <span class="nn">avi.utils.data.data_file</span> <span class="kn">import</span> <span class="n">data_file</span> <span class="k">as</span> <span class="n">data</span></pre>

                                        <pre><span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span></pre>
                                        <pre><span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">Arrow</span><span class="p">,</span> <span class="n">VeeHead</span></pre>
                                    
                                    
                                    <pre><span class="k">class</span> <span class="nc">Gaia_PM</span><span class="p">:</span></pre>
                                        <pre>   <span class="c1"># Initialize the Gaia table</span></pre>
                                        <pre>   <span class="n">gaia_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                                
                                        <pre>   <span class="c1"># Starts</span></pre>
                                        <pre>   <span class="n">number_stars_displayed</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
                        
                                        <pre>   <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span></pre>
                                        <pre>       <span class="c1">## Gaia VOTABLE</span></pre>
                
                                        <pre>       <span class="c1"># Extract the information from VOTable file</span></pre>
                                        <pre>       <span class="n">gaia_data</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaia_file</span><span class="p">)</span></pre>
                                        <pre>       <span class="n">gaia_list</span> <span class="o">=</span> <span class="n">gaia_data</span><span class="o">.</span><span class="n">get_first_table</span><span class="p">()</span><span class="o">.</span><span class="n">array</span></pre>

                                        <pre>       <span class="c1"># Parallax obtained from Gaia from the different stars changing units</span></pre>
                                        <pre>       <span class="c1"># from mas to arcseconds</span></pre>
                                        <pre>       <span class="c1"># https://gea.esac.esa.int/archive/documentation/GDR2/Gaia_archive/chap_datamodel/sec_dm_main_tables/ssec_dm_gaia_source.html</span></pre>

                                        <pre>       <span class="n">paralf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;parallax&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span></pre>

                                        <pre>       <span class="c1"># Selection a smaller number of stars (number_stars_displayed)</span></pre>

                                        <pre>       <span class="n">paralf</span> <span class="o">=</span> <span class="n">paralf</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_stars_displayed</span><span class="p">]</span></pre>

                                        <pre>       <span class="c1"># Get the coordinates in the cluster</span></pre>

                                        <pre>       <span class="c1"># Proper motion in declination direction (double, Angular Velocity[mas/year] )</span></pre>
                                        <pre>       <span class="n">propermot_de_sf</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;pmdec&#39;</span><span class="p">]</span></pre>
                                        <pre>       <span class="c1"># Proper motion in right ascension direction (double, Angular Velocity[mas/year])</span></pre>
                                        <pre>       <span class="n">propermot_ra_sf</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;pmra&#39;</span><span class="p">]</span></pre>
                                        <pre>       <span class="c1"># Declination (double, Angle[deg])</span></pre>
                                        <pre>       <span class="n">dec_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span></pre>
                                        <pre>       <span class="c1"># Right ascension (double, Angle[deg])</span></pre>
                                        <pre>       <span class="n">ra_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span></pre>
                                        <pre>       <span class="c1"># Stellar radius (float, Length &amp; Distance[Solar Radius])</span></pre>
                                        <pre>       <span class="n">radiof</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;radius_val&#39;</span><span class="p">]</span></pre>

                                        <pre>       <span class="c1"># Creation of an array that will contain only  the number of the rows of</span></pre>
                                        <pre>       <span class="c1"># stars with a known PM</span></pre>
                                        <pre>       <span class="n">starts_with_PM</span><span class="o">=</span><span class="p">[]</span></pre>

                                        <pre>       <span class="c1"># Get index of the array with values of PM</span></pre>
                                        <pre>       <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paralf</span><span class="p">)):</span></pre>
                                            <pre>           <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">propermot_de_sf</span><span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">:</span></pre>
                                                <pre>           <span class="n">starts_with_PM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></pre>
                                    
                                    
                                                <pre>       <span class="c1"># We initialize the arrays necessary for the subsequent analysis.</span></pre>
                                                <pre>       <span class="n">propermot_de_sf_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">))</span></pre>
                                                <pre>       <span class="n">propermot_ra_sf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">))</span></pre>
                                                <pre>       <span class="n">dec_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">))</span></pre>
                                                <pre>       <span class="n">ra_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">))</span></pre>
                                                <pre>       <span class="n">radiof_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">))</span></pre>
                                    
                                                <pre>       <span class="c1"># Function that fills the empty vectors with the real data from Gaia,</span></pre>
                                                <pre>       <span class="c1"># including only the stars with a known proper motion</span></pre>
                                                <pre>       <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_PM</span><span class="p">)):</span></pre>
                                                            <pre>           <span class="c1"># The proper motions are given in arcseconds per year so they are</span></pre>
                                                            <pre>           <span class="c1"># divided by a factor of 3600 to change the units to degrees</span></pre>
                                                            <pre>           <span class="n">propermot_de_sf_new</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="n">propermot_de_sf</span><span class="p">[</span><span class="n">starts_with_PM</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">/</span><span class="mi">3600</span></pre>
                                                            <pre>           <span class="n">propermot_ra_sf_new</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="n">propermot_ra_sf</span><span class="p">[</span><span class="n">starts_with_PM</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">/</span><span class="mi">3600</span></pre>
                                                            <pre>           <span class="n">dec_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dec_colf</span><span class="p">[</span><span class="n">starts_with_PM</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                            <pre>           <span class="n">ra_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ra_colf</span><span class="p">[</span><span class="n">starts_with_PM</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                            <pre>           <span class="n">radiof_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">radiof</span><span class="p">[</span><span class="n">starts_with_PM</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                    
                                                    <pre>       <span class="c1"># Definition of the variables that will be used to plot the coordinates</span></pre>
                                                    <pre>       <span class="c1"># of the stars in 2D (right ascension and declination in degrees)</span></pre>
                                                    <pre>       <span class="n">x</span> <span class="o">=</span> <span class="n">ra_colf_new</span></pre>
                                                    <pre>       <span class="n">y</span> <span class="o">=</span> <span class="n">dec_colf_new</span></pre>
                                    
                                                    <pre>       <span class="c1"># Definition of the variables that will be used to plot the proper</span></pre>
                                                    <pre>       <span class="c1"># motions of the stars in 2D in degrees per year (they are multiplied by</span></pre>
                                                    <pre>       <span class="c1"># a factor of 10 to make the proportions more visually understandable in</span></pre>
                                                    <pre>       <span class="c1"># the plot)</span></pre>
                                    
                                                    <pre>       <span class="n">u</span> <span class="o">=</span> <span class="n">propermot_ra_sf_new</span><span class="o">*</span><span class="mi">10</span></pre>
                                                    <pre>       <span class="n">v</span> <span class="o">=</span> <span class="n">propermot_de_sf_new</span><span class="o">*</span><span class="mi">10</span></pre>
                                    
                                                    <pre>       <span class="c1"># Definition of the graph range and selection of an adequate margin</span></pre>
                                                    <pre>       <span class="n">margin</span> <span class="o">=</span> <span class="mf">0.07</span></pre>
                                                    <pre>       <span class="n">max_ra</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ra_colf_new</span><span class="p">)</span> <span class="o">+</span> <span class="n">margin</span></pre>
                                                    <pre>       <span class="n">min_ra</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ra_colf_new</span><span class="p">)</span> <span class="o">-</span> <span class="n">margin</span></pre>
                                                    <pre>       <span class="n">max_de</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dec_colf_new</span><span class="p">)</span> <span class="o">+</span> <span class="n">margin</span></pre>
                                                    <pre>       <span class="n">min_de</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dec_colf_new</span><span class="p">)</span> <span class="o">-</span> <span class="n">margin</span></pre>
                                    
                                                    <pre>       <span class="c1"># Definition of the function that plots the stars and the arrows that</span></pre>
                                                    <pre>       <span class="c1"># represent the proper motions</span></pre>
                                                    <pre>       <span class="k">def</span> <span class="nf">radvel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">max_ra</span><span class="p">,</span> <span class="n">min_ra</span><span class="p">,</span> <span class="n">max_de</span><span class="p">,</span> <span class="n">min_de</span><span class="p">):</span></pre>
                                                        <pre>           <span class="c1"># Creation of the image</span></pre>
                                                            <pre>           <span class="n">p</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Proper motions&quot;</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="n">min_ra</span><span class="p">,</span><span class="n">max_ra</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="n">min_de</span><span class="p">,</span><span class="n">max_de</span><span class="p">))</span></pre>
                                                            <pre>           <span class="c1"># Creation of the points that represent the stars and their color</span></pre>
                                                            <pre>           <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#FFD700&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;#FF8C00&quot;</span> <span class="p">,</span><span class="n">radius</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">)</span></pre>
                                                            <pre>           <span class="c1"># Title of the axis and units</span></pre>
                                                            <pre>           <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Right ascension (Degrees)&quot;</span></pre>
                                                            <pre>           <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Declination (Degrees)&quot;</span></pre>
                                                            <pre>           <span class="c1"># Creation of the arrows of each star representing their proper motions. The color is chosen too.</span></pre>
                                                            <pre>           <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span></pre>
                                                            <pre>           <span class="n">p</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">Arrow</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="n">VeeHead</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y_start</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x_end</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y_end</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span></pre>
                                    
                                                    <pre>           <span class="n">save_plot</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;gaia&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>  <span class="c1"># open a browser</span></pre>
                                                    <pre>           <span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1"># The function above is called to obtain the wanted graph</span></pre>
                                                    <pre>       <span class="n">p</span> <span class="o">=</span> <span class="n">radvel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">max_ra</span><span class="p">,</span> <span class="n">min_ra</span><span class="p">,</span> <span class="n">max_de</span><span class="p">,</span> <span class="n">min_de</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1"># Save the results</span></pre>
                                                    <pre>       <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_stars_displayed</span></pre>
                                                    <pre>       <span class="n">my_file</span> <span class="o">=</span> <span class="n">data</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="o">.</span><span class="n">file</span><span class="p">(</span><span class="s2">&quot;my_results.txt&quot;</span><span class="p">)</span></pre>
                                                    <pre>       <span class="n">my_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">))</span></pre></pre>
                                                    <pre>       <span class="n">my_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></pre>
                                </code></div>
                                    </div>
                                <h5 class="text-left mt-3">1.2 - Gaia_pm.json</h5>
                                <p class="text">In addition to the python file, we must create the json file to automatically generate the form in DEAVI.</p>
                                <div class="highlight-json notranslate text-left">
                                    <div class="highlight p-4">
                                        <code>
                                        <pre><span class="p">{</span><span class="nt">&quot;algorithm&quot;</span><span class="p">:{</span></pre>
                                        <pre>   <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Gaia_PM&quot;</span><span class="p">,</span></pre>
                                        <pre>   <span class="nt">&quot;view_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Gaia Data with their Proper Motions (PM)&quot;</span><span class="p">,</span></pre>
                                        <pre>   <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;h3&gt;Gaia Data with PM&lt;/h3&gt;&lt;p&gt;An representation of Gaia data with the proper motions&lt;/p&gt;&quot;</span><span class="p">,</span></pre>
                                        <pre>   <span class="nt">&quot;input&quot;</span><span class="p">:{</span></pre>
                                            <pre>       <span class="nt">&quot;input_1&quot;</span><span class="p">:{</span></pre>
                                                <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;gaia_file&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Gaia VOTable&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;gaia_table&quot;</span></pre>
                                            <pre>       <span class="p">},</span></pre>
                                            <pre>       <span class="nt">&quot;input_2&quot;</span><span class="p">:{</span></pre>
                                                <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;number_stars_displayed&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Number of stars&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;float&quot;</span></pre>
                                            <pre>       <span class="p">}</span></pre>
                                        <pre>   <span class="p">}</span></pre>
                                        <pre><span class="p">}}</span></pre>
                                        </code>
                                    </div>
                                </div> -->
                                <!-- <h3 class="text-left mt-4"><b>2 - Wien’s Law and Hertzsprung-Russell Diagram (HRD)</b></h3>
                                <p class="text">By slightly modifying the previous algorithm, we can use other characteristics. In this case, we have plotted the Wien’s law and the HDR in two independent figures.</p>
                                <h5 class="text-left">2.1 - Wien_HDR.py</h5>
                                <div class="highlight-python notranslate text-left">
                                    <div class="highlight p-4">
                                        <code>
                                    
                                    <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                    <pre><span class="sd">Copyright (C) 2016-2020 Quasar Science Resources, S.L.</span></pre>
                                    
                                    <pre><span class="sd">This file is part of DEAVI.</span></pre>
                                    
                                    <pre><span class="sd">DEAVI is free software: you can redistribute it and/or modify</span></pre>
                                    <pre><span class="sd">it under the terms of the GNU General Public License as published by</span></pre>
                                    <pre><span class="sd">the Free Software Foundation, either version 3 of the License, or</span></pre>
                                    <pre><span class="sd">(at your option) any later version.</span></pre>
                                    
                                    <pre><span class="sd">DEAVI is distributed in the hope that it will be useful,</span></pre>
                                    <pre><span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span></pre>
                                    <pre><span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></pre>
                                    <pre><span class="sd">GNU General Public License for more details.</span></pre>
                                    
                                    <pre><span class="sd">You should have received a copy of the GNU General Public License</span></pre>
                                    <pre><span class="sd">along with DEAVI.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></pre>
                                    <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                    <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                    
                                    <pre><span class="sd">Example 2: Wien&#39;s Law and Hertzsprung-Russell Diagram (HRD). The input file is a VOTable</span></pre>
                                    <pre><span class="sd">from the Gaia Archive</span></pre>
                                    <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                    
                                    <pre><span class="c1"># Import the necessary modules</span></pre>
                                    <pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span></pre>
                                    
                                    <pre><span class="kn">from</span> <span class="nn">astropy.io.votable</span> <span class="kn">import</span> <span class="n">parse</span></pre>
                                    <pre><span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span></pre>
                                    
                                    <pre><span class="kn">from</span> <span class="nn">avi.utils.plotter</span> <span class="kn">import</span> <span class="n">save_plot</span></pre>
                                    
                                    <pre><span class="k">class</span> <span class="nc">Wien_HDR</span><span class="p">:</span></pre>
                                            <pre>   <span class="c1"># Initialize the Gaia table</span></pre>
                                            <pre>   <span class="n">gaia_table</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                                    
                                            <pre>   <span class="c1"># Starts</span></pre>
                                            <pre>   <span class="n">number_stars_displayed</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
                                            <pre>   <span class="n">proportional_size</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span></pre>
                                    
                                            <pre>   <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">id</span><span class="p">):</span></pre>
                                                    <pre>       <span class="c1">## Gaia VOTABLE</span></pre>
                                    
                                                    <pre>       <span class="c1"># Extract the information from VOTable file</span></pre>
                                                    <pre>       <span class="n">gaia</span> <span class="o">=</span><span class="n">parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaia_table</span><span class="p">)</span></pre>
                                                    <pre>       <span class="n">gaia_list</span> <span class="o">=</span> <span class="n">gaia</span><span class="o">.</span><span class="n">get_first_table</span><span class="p">()</span><span class="o">.</span><span class="n">array</span></pre>
                                    
                                                    <pre>       <span class="c1"># Parallax obtained from gaia from the different stars changing units</span></pre>
                                                    <pre>       <span class="c1"># from mas to arcseconds</span></pre>
                                                    <pre>       <span class="n">par</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;parallax&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span></pre>
                                    
                                                    <pre>       <span class="c1"># Selection a smaller number of stars (number_stars_displayed)</span></pre>
                                                    <pre>       <span class="n">paralf</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_stars_displayed</span><span class="p">]</span></pre>
                                    
                                                    <pre>       <span class="c1"># Get the coordinates in the cluster</span></pre>
                                                    <pre>       <span class="c1"># https://gea.esac.esa.int/archive/documentation/GDR2/Gaia_archive/chap_datamodel/sec_dm_main_tables/ssec_dm_gaia_source.html</span></pre>
                                                    <pre>       <span class="c1"># Declination (double, Angle[deg])</span></pre>
                                                    <pre>       <span class="n">dec_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span></pre>
                                                    <pre>       <span class="c1"># Right ascension (double, Angle[deg])</span></pre>
                                                    <pre>       <span class="n">ra_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span></pre>
                                                    <pre>       <span class="c1"># Stellar radius (float, Length &amp; Distance[Solar Radius])</span></pre>
                                                    <pre>       <span class="n">radiof</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;radius_val&#39;</span><span class="p">]</span></pre>
                                                    <pre>       <span class="c1"># Stellar effective temperature (float, Temperature[K])</span></pre>
                                                    <pre>       <span class="n">temperature</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;teff_val&#39;</span><span class="p">]</span></pre>
                                                    <pre>       <span class="c1"># stellar luminosity (float, Luminosity[Solar Luminosity])</span></pre>
                                                    <pre>       <span class="n">luminosity</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;lum_val&#39;</span><span class="p">]</span></pre>
                                    
                                                    <pre>       <span class="c1"># Creation of an array that will contain only  the number of the rows of</span></pre>
                                                    <pre>       <span class="c1"># stars with a known T, radio and luminosity</span></pre>
                                                    <pre>       <span class="n">starts_with_T</span><span class="o">=</span><span class="p">[]</span></pre>
                                    
                                                    <pre>       <span class="c1"># Get index of the array with values of temperature, radio and luminosity</span></pre>
                                                    <pre>       <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paralf</span><span class="p">)):</span></pre>
                                                        <pre>          <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">temperature</span><span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">radiof</span> <span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">luminosity</span> <span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">):</span></pre>
                                                        <pre>              <span class="n">starts_with_T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1"># We initialize the arrays necessary for the subsequent analysis.</span></pre>
                                                    <pre>       <span class="n">dec_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">))</span></pre>
                                                    <pre>       <span class="n">ra_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">))</span></pre>
                                                    <pre>       <span class="n">temperature_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">))</span></pre>
                                                    <pre>       <span class="n">radiof_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">))</span></pre>
                                                    <pre>       <span class="n">luminosity_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">))</span></pre>
                                    
                                                    <pre>       <span class="c1"># Function that fills the empty vectors with the real data from gaia,</span></pre>
                                                    <pre>       <span class="c1"># including only the stars with a known T</span></pre>
                                                    <pre>       <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_T</span><span class="p">)):</span></pre>
                                                            <pre>           <span class="n">dec_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dec_colf</span><span class="p">[</span><span class="n">starts_with_T</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                            <pre>           <span class="n">ra_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ra_colf</span><span class="p">[</span><span class="n">starts_with_T</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                            <pre>           <span class="n">temperature_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">temperature</span><span class="p">[</span><span class="n">starts_with_T</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                            <pre>           <span class="n">radiof_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">radiof</span><span class="p">[</span><span class="n">starts_with_T</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                            <pre>           <span class="n">luminosity_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">luminosity</span><span class="p">[</span><span class="n">starts_with_T</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                    
                                    
                                                    <pre>       <span class="c1"># Definition of the variables that will be used to plot the coordinates</span></pre>
                                                    <pre>       <span class="c1"># of the stars in 2D (right ascension and declination in degrees)</span></pre>
                                                    <pre>       <span class="n">x</span> <span class="o">=</span> <span class="n">ra_colf_new</span></pre>
                                                    <pre>       <span class="n">y</span> <span class="o">=</span> <span class="n">dec_colf_new</span></pre>
                                    
                                                    <pre>       <span class="c1"># In order to define the figure, we need some auxiliary values</span></pre>
                                    
                                                    <pre>       <span class="n">max_ra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ra_colf_new</span><span class="p">)</span><span class="o">+</span><span class="mf">0.25</span></pre>
                                                    <pre>       <span class="n">min_ra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ra_colf_new</span><span class="p">)</span><span class="o">-</span><span class="mf">0.25</span></pre>
                                                    <pre>       <span class="n">max_de</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dec_colf_new</span><span class="p">)</span><span class="o">+</span><span class="mf">0.25</span></pre>
                                                    <pre>       <span class="n">min_de</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dec_colf_new</span><span class="p">)</span><span class="o">-</span><span class="mf">0.25</span></pre>
                                    
                                                    <pre>       <span class="n">luminosity_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">luminosity_new</span><span class="p">)</span></pre>
                                                    <pre>       <span class="n">min_T</span> <span class="o">=</span> <span class="n">temperature_new</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.1</span></pre>
                                                    <pre>       <span class="n">max_T</span> <span class="o">=</span> <span class="n">temperature_new</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span></pre>
                                                    <pre>       <span class="n">min_L</span> <span class="o">=</span> <span class="n">luminosity_new</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.1</span></pre>
                                                    <pre>       <span class="n">max_L</span> <span class="o">=</span> <span class="n">luminosity_new</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span></pre>
                                    
                                                    <pre>       <span class="k">def</span> <span class="nf">wien_law</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">temperature_new</span><span class="p">,</span> <span class="n">min_ra</span><span class="p">,</span> <span class="n">max_ra</span><span class="p">,</span> <span class="n">min_de</span><span class="p">,</span> <span class="n">max_de</span><span class="p">,</span> <span class="n">radiof_new</span><span class="p">):</span></pre>
                                                        <pre>           <span class="n">p</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Wien’s Law with a proportional radius size&quot;</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="n">max_ra</span><span class="p">,</span> <span class="n">min_ra</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="n">min_de</span><span class="p">,</span><span class="n">max_de</span><span class="p">))</span></pre>
                                                        <pre>           <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Right ascension (Degrees)&quot;</span></pre>
                                                        <pre>           <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Declination (Degrees)&quot;</span></pre>
                                    
                                                        <pre>           <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">)):</span></pre>
                                                                <pre>               <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proportional_size</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span></pre>
                                                                <pre>                   <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">/</span><span class="mi">45</span><span class="p">)</span></pre>
                                                                <pre>               <span class="k">else</span><span class="p">:</span></pre>
                                                                <pre>                   <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.008</span></pre>
                                                                <pre>               <span class="c1"># Class O, onized and neutral helium, weakened hydrogen --&gt; blueish</span></pre>
                                                                <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">31000</span><span class="p">:</span></pre>
                                                                <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ADD8E6&quot;</span><span class="p">)</span></pre>
                                                                <pre>               <span class="c1"># Class B, Neutral helium, stronger hydrogen --&gt; Blue-white</span></pre>
                                                                <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">31000</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">9750</span><span class="p">:</span></pre>
                                                                <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#e6ffff&quot;</span><span class="p">)</span></pre>
                                                                <pre>               <span class="c1"># Class A, Stronger hydrogen, ionized metals --&gt; White</span></pre>
                                                                <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">9750</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">7100</span><span class="p">:</span></pre>
                                                                <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">)</span></pre>
                                                                <pre>               <span class="c1"># Class F, Weaker hydrogen, ionized metals --&gt; Yellow - White</span></pre>
                                                                <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">7100</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5950</span><span class="p">:</span></pre>
                                                                <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffffcc&quot;</span><span class="p">)</span></pre>
                                                                <pre>               <span class="c1"># Class G Weak hydrogen, ionized and neutral metals --&gt; Yellowish</span></pre>
                                                                <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5950</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5250</span><span class="p">:</span></pre>
                                                                <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffff66&quot;</span><span class="p">)</span></pre>
                                                                <pre>               <span class="c1"># Class K, Weak hydrogen, neutral metals --&gt; Orange</span></pre>
                                                                <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5250</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3950</span><span class="p">:</span></pre>
                                                                <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ff9900&quot;</span><span class="p">)</span></pre>
                                                                <pre>               <span class="c1"># Class M, Little or no hydrogen, neutral metals, molecules --&gt; Reddish</span></pre>
                                                                <pre>               <span class="k">if</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3950</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span></pre>
                                                                <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ff9980&quot;</span><span class="p">)</span></pre>
                                    
                                                        <pre>           <span class="n">save_plot</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;stars_temperature&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></pre>
                                                        <pre>           <span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="k">def</span> <span class="nf">hertzsprung_russell_diagram</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">,</span> <span class="n">luminosity_new</span><span class="p">,</span> <span class="n">radiof_new</span><span class="p">):</span></pre>
                                    
                                                        <pre>           <span class="n">p</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Hertzsprung-Russell Diagram (HRD)&quot;</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="n">max_T</span><span class="p">,</span> <span class="n">min_T</span><span class="p">),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="n">min_L</span><span class="p">,</span><span class="n">max_L</span><span class="p">))</span></pre>
                                                        <pre>           <span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Surface Temperature (k)&quot;</span></pre>
                                                        <pre>           <span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s2">&quot;Luminosity (Solar Luminosity)&quot;</span></pre>
                                    
                                    
                                                        <pre>           <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">)):</span></pre>
                                                        <pre>               <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span></pre>
                                    
                                                        <pre>               <span class="c1"># Class O, onized and neutral helium, weakened hydrogen --&gt; blueish</span></pre>
                                                        <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">31000</span><span class="p">:</span></pre>
                                                        <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ADD8E6&quot;</span><span class="p">)</span></pre>
                                                        <pre>               <span class="c1"># Class B, Neutral helium, stronger hydrogen --&gt; Blue-white</span></pre>
                                                        <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">31000</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">9750</span><span class="p">:</span></pre>
                                                        <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#e6ffff&quot;</span><span class="p">)</span></pre>
                                                        <pre>               <span class="c1"># Class A, Stronger hydrogen, ionized metals --&gt; White</span></pre>
                                                        <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">9750</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">7100</span><span class="p">:</span></pre>
                                                        <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffffff&quot;</span><span class="p">)</span></pre>
                                                        <pre>               <span class="c1"># Class F, Weaker hydrogen, ionized metals --&gt; Yellow - White</span></pre>
                                                        <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">7100</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5950</span><span class="p">:</span></pre>
                                                        <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffffcc&quot;</span><span class="p">)</span></pre>
                                                        <pre>               <span class="c1"># Class G, Weak hydrogen, ionized and neutral metals --&gt; Yellowish</span></pre>
                                                        <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5950</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5250</span><span class="p">:</span></pre>
                                                        <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ffff66&quot;</span><span class="p">)</span></pre>
                                                        <pre>               <span class="c1"># Class K, Weak hydrogen, neutral metals --&gt; Orange</span></pre>
                                                        <pre>               <span class="k">if</span> <span class="n">temperature_new</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5250</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3950</span><span class="p">:</span></pre>
                                                        <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ff9900&quot;</span><span class="p">)</span></pre>
                                                        <pre>               <span class="c1"># Class M, Little or no hydrogen, neutral metals, molecules --&gt; Reddish</span></pre>
                                                        <pre>               <span class="k">if</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3950</span> <span class="ow">and</span> <span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2000</span><span class="p">:</span></pre>
                                                        <pre>                   <span class="n">p</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">luminosity_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">radiof_new</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#ff9980&quot;</span><span class="p">)</span></pre>
                                    
                                                        <pre>           <span class="n">save_plot</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;stars_temperature&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></pre>
                                                        <pre>           <span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="n">p1</span> <span class="o">=</span> <span class="n">wien_law</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">temperature_new</span><span class="p">,</span> <span class="n">min_ra</span><span class="p">,</span> <span class="n">max_ra</span><span class="p">,</span> <span class="n">min_de</span><span class="p">,</span> <span class="n">max_de</span><span class="p">,</span> <span class="n">radiof_new</span><span class="p">)</span></pre>
                                                    <pre>       <span class="n">p2</span> <span class="o">=</span> <span class="n">hertzsprung_russell_diagram</span><span class="p">(</span><span class="n">temperature_new</span><span class="p">,</span> <span class="n">luminosity_new</span><span class="p">,</span> <span class="n">radiof_new</span><span class="p">)</span></pre>
                                            </code>
                                        </div>
                                    </div>



                                <h5 class="text-left mt-4">2.2 - Wien_HDR.json</h5>
                                <div class="highlight-json notranslate text-left">
                                    <div class="highlight p-4">
                                        <code>
                                    <pre><span class="p">{</span><span class="nt">&quot;algorithm&quot;</span><span class="p">:{</span></pre>
                                    <pre>   <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Wien_HDR&quot;</span><span class="p">,</span></pre>
                                    <pre>   <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Wien Law and Hertzsprung-Russell Diagram (HRD)&quot;</span><span class="p">,</span></pre>
                                    <pre>   <span class="nt">&quot;input&quot;</span><span class="p">:{</span></pre>
                                            <pre>       <span class="nt">&quot;input_1&quot;</span><span class="p">:{</span></pre>
                                                    <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;gaia_table&quot;</span><span class="p">,</span></pre>
                                                    <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Gaia VOTable&quot;</span><span class="p">,</span></pre>
                                                    <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;gaia_table&quot;</span></pre>
                                            <pre>       <span class="p">},</span></pre>
                                            <pre>       <span class="nt">&quot;input_2&quot;</span><span class="p">:{</span></pre>
                                                <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;proportional_size&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Size proportional to the radious (y/n)&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;string&quot;</span></pre>
                                            <pre>       <span class="p">},</span></pre>
                                            <pre>       <span class="nt">&quot;input_3&quot;</span><span class="p">:{</span></pre>
                                                <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;number_stars_displayed&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Number of the stars&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span></pre>
                                            <pre>       <span class="p">}</span></pre>
                                    <pre>   <span class="p">}</span></pre>
                                <pre><span class="p">}}</span></pre>
                                </code>
                                </div>
                            </div> -->



                                <!-- <h3 class="text-left mt-4"><b>3 - Plotting Gaia and Herschel data simultaneously</b></h3>
                                <p class="text">The last example shows how use Herschel data. In this case, we modify the first example so that the Gaia and Herschel data are displayed simultaneously.</p>
                                <h5 class="text-left">3.1 - Gaia_Herschel.py</h5>
                                <div class="highlight-python notranslate text-left">
                                    <div class="highlight p-4">
                                        <code>
                                    
                                    <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                    <pre><span class="sd">Copyright (C) 2016-2020 Quasar Science Resources, S.L.</span></pre>
                                    
                                    <pre><span class="sd">This file is part of DEAVI.</span></pre>
                                    
                                    <pre><span class="sd">DEAVI is free software: you can redistribute it and/or modify</span></pre>
                                    <pre><span class="sd">it under the terms of the GNU General Public License as published by</span></pre>
                                    <pre><span class="sd">the Free Software Foundation, either version 3 of the License, or</span></pre>
                                    <pre><span class="sd">(at your option) any later version.</span></pre>
                                    
                                    <pre><span class="sd">DEAVI is distributed in the hope that it will be useful,</span></pre>
                                    <pre><span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span></pre>
                                    <pre><span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></pre>
                                    <pre><span class="sd">GNU General Public License for more details.</span></pre>
                                    
                                    <pre><span class="sd">You should have received a copy of the GNU General Public License</span></pre>
                                    <pre><span class="sd">along with DEAVI.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></pre>
                                    <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                    <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                    
                                    <pre><span class="sd">Example 3: This algorithm plots the positions of a certain number of stars in a</span></pre>
                                    <pre><span class="sd">cluster together with their respective proper motions. Also, it plot the Herschel</span></pre>
                                    <pre><span class="sd">image in the same coordinates.</span></pre>
                                    <pre><span class="sd">&quot;&quot;&quot;</span></pre>
                                    <pre><span class="c1"># Import the necessary modules</span></pre>
                                    <pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span></pre>
                                    
                                    <pre><span class="kn">from</span> <span class="nn">astropy.io.votable</span> <span class="kn">import</span> <span class="n">parse</span></pre>
                                    <pre><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span></pre>
                                    <pre><span class="kn">from</span> <span class="nn">astropy.wcs</span> <span class="kn">import</span> <span class="n">WCS</span></pre>
                                    <pre><span class="kn">from</span> <span class="nn">astropy.nddata</span> <span class="kn">import</span> <span class="n">block_reduce</span></pre>
                                    
                                    <pre><span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span></pre>
                                    <pre><span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">Arrow</span><span class="p">,</span> <span class="n">VeeHead</span><span class="p">,</span> <span class="n">LogColorMapper</span><span class="p">,</span> <span class="n">ColorBar</span><span class="p">,</span> <span class="n">LogTicker</span></pre>
                                    
                                    <pre><span class="kn">from</span> <span class="nn">avi.utils.plotter</span> <span class="kn">import</span> <span class="n">save_plot</span></pre>
                                    <pre><span class="kn">from</span> <span class="nn">avi.utils.data.data_file</span> <span class="kn">import</span> <span class="n">data_file</span> <span class="k">as</span> <span class="n">data</span></pre>
                                    
                                    
                                    <pre><span class="k">class</span> <span class="nc">Gaia_Herschel</span><span class="p">:</span></pre>
                                            <pre>   <span class="c1"># Initialize the Gaia and Herschel tables</span></pre>
                                            <pre>   <span class="n">gaia_table</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                                            <pre>   <span class="n">hsa_table</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span></pre>
                                    
                                            <pre>   <span class="c1"># Starts</span></pre>
                                            <pre>   <span class="n">number_stars_displayed</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
                                    
                                            <pre>   <span class="c1"># Downsample a data array by applying a function to local blocks.</span></pre>
                                            <pre>   <span class="c1"># See http://docs.astropy.org/en/stable/api/astropy.nddata.block_reduce.html</span></pre>
                                            <pre>   <span class="n">size_block</span> <span class="o">=</span> <span class="mi">1</span></pre>
                                    
                                    
                                            <pre>   <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">id</span><span class="p">):</span></pre>
                                                    <pre>       <span class="c1">## Herschel FITS</span></pre>
                                    
                                                    <pre>       <span class="c1"># Load the FITS file with the world coordinate system</span></pre>
                                                    <pre>       <span class="n">herschel</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hsa_table</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1"># FITS files have some extensions, we separate them</span></pre>
                                                    <pre>       <span class="n">head</span> <span class="o">=</span> <span class="n">herschel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span></pre>
                                                    <pre>       <span class="c1"># The information is located in the extension 1</span></pre>
                                                    <pre>       <span class="n">im</span> <span class="o">=</span> <span class="n">herschel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span></pre>
                                    
                                                    <pre>       <span class="c1"># The World Coordinate System information is located in the header so</span></pre>
                                                    <pre>       <span class="n">w</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">head</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1"># In order to define the figure, we need to create two ndarrays</span></pre>
                                                    <pre>       <span class="n">xpx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span></pre>
                                                    <pre>       <span class="n">ypx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span></pre>
                                    
                                                    <pre>       <span class="c1"># Now, we create the grid using the previous ndarrays</span></pre>
                                                    <pre>       <span class="n">xlist</span><span class="p">,</span> <span class="n">ylist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xpx</span><span class="p">,</span><span class="n">ypx</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1"># We want a plot in WCS so we need to convert pixels to WCS</span></pre>
                                                    <pre>       <span class="n">ralist</span><span class="p">,</span> <span class="n">declist</span><span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_pix2world</span><span class="p">(</span><span class="n">xlist</span><span class="p">,</span> <span class="n">ylist</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1">## Gaia VOTABLE</span></pre>
                                    
                                                    <pre>       <span class="c1"># Extract the information from VOTABLE file</span></pre>
                                                    <pre>       <span class="n">gaia</span> <span class="o">=</span><span class="n">parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gaia_table</span><span class="p">)</span></pre>
                                                    <pre>       <span class="n">gaia_list</span> <span class="o">=</span> <span class="n">gaia</span><span class="o">.</span><span class="n">get_first_table</span><span class="p">()</span><span class="o">.</span><span class="n">array</span></pre>
                                    
                                                    <pre>       <span class="c1"># Parallax obtained from gaia from the different stars changing units</span></pre>
                                                    <pre>       <span class="c1"># from mas to arcseconds</span></pre>
                                                    <pre>       <span class="n">par</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;parallax&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span></pre>
                                    
                                                    <pre>       <span class="c1"># Selection a smaller number of stars (number_stars_displayed)</span></pre>
                                                    <pre>       <span class="n">paralf</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">number_stars_displayed</span><span class="p">]</span></pre>
                                    
                                                    <pre>       <span class="c1"># Get the coordinates and proper motions of the stars in the cluster</span></pre>
                                                    <pre>       <span class="c1"># https://gea.esac.esa.int/archive/documentation/GDR2/Gaia_archive/chap_datamodel/sec_dm_main_tables/ssec_dm_gaia_source.html</span></pre>
                                                    <pre>       <span class="c1"># Proper motion in declination direction (double, Angular Velocity[mas/year] )</span></pre>
                                                    <pre>       <span class="n">propermot_de_sf</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;pmdec&#39;</span><span class="p">]</span></pre>
                                                    <pre>       <span class="c1"># Proper motion in right ascension direction (double, Angular Velocity[mas/year])</span></pre>
                                                    <pre>       <span class="n">propermot_ra_sf</span><span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;pmra&#39;</span><span class="p">]</span></pre>
                                                    <pre>       <span class="c1"># Declination (double, Angle[deg])</span></pre>
                                                    <pre>       <span class="n">dec_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span></pre>
                                                    <pre>       <span class="c1"># Right ascension (double, Angle[deg])</span></pre>
                                                    <pre>       <span class="n">ra_colf</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span></pre>
                                                    <pre>       <span class="c1"># Stellar radius (float, Length &amp; Distance[Solar Radius])</span></pre>
                                                    <pre>       <span class="n">radiof</span> <span class="o">=</span> <span class="n">gaia_list</span><span class="p">[</span><span class="s1">&#39;radius_val&#39;</span><span class="p">]</span></pre>
                                    
                                                    <pre>       <span class="c1"># Creation of an array that will contain only  the number of the rows of</span></pre>
                                                    <pre>       <span class="c1"># stars with a known proper motion (DR2)</span></pre>
                                                    <pre>       <span class="n">starts_with_pm</span><span class="o">=</span><span class="p">[]</span></pre>
                                    
                                                    <pre>       <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paralf</span><span class="p">)):</span></pre>
                                                    <pre>           <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">propermot_de_sf</span><span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MaskedConstant</span><span class="p">:</span></pre>
                                                            <pre>               <span class="n">starts_with_pm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1"># We initialize the arrays necessary for the subsequent analysis.</span></pre>
                                                    <pre>       <span class="n">propermot_de_sf_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                    <pre>       <span class="n">propermot_ra_sf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                    <pre>       <span class="n">dec_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                    <pre>       <span class="n">ra_colf_new</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                    <pre>       <span class="n">paral_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                                    <pre>       <span class="n">radiof_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">))</span></pre>
                                    
                                                    <pre>       <span class="c1"># Function that fills the empty vectors with the real data from gaia,</span></pre>
                                                    <pre>       <span class="c1"># including only the stars with a known proper motion</span></pre>
                                                    <pre>       <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starts_with_pm</span><span class="p">)):</span></pre>
                                                        <pre>           <span class="c1"># The proper motions are given in arcseconds per year so they are</span></pre>
                                                        <pre>           <span class="c1"># divided by a factor of 3600 to change the units to degrees</span></pre>
                                                        <pre>           <span class="n">propermot_de_sf_new</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="n">propermot_de_sf</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">/</span><span class="mi">3600</span></pre>
                                                        <pre>           <span class="n">propermot_ra_sf_new</span> <span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span> <span class="n">propermot_ra_sf</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">/</span><span class="mi">3600</span></pre>
                                                        <pre>           <span class="n">dec_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">dec_colf</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                        <pre>           <span class="n">ra_colf_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ra_colf</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                        <pre>           <span class="n">paral_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">paralf</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                                        <pre>           <span class="n">radiof_new</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">radiof</span><span class="p">[</span><span class="n">starts_with_pm</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span></pre>
                                    
                                                    <pre>       <span class="c1">#Definition of the variables that will be used to plot the coordinates</span></pre>
                                                    <pre>       <span class="c1"># of the stars in 2D (right ascension and declination in degrees)</span></pre>
                                                    <pre>       <span class="n">x</span> <span class="o">=</span> <span class="n">ra_colf_new</span></pre>
                                                    <pre>       <span class="n">y</span> <span class="o">=</span> <span class="n">dec_colf_new</span></pre>
                                    
                                    
                                                    <pre>       <span class="c1"># Definition of the variables that will be used to plot the proper</span></pre>
                                                    <pre>       <span class="c1"># motions of the stars in 2D in degrees per year (they are multiplied by</span></pre>
                                                    <pre>       <span class="c1"># a factor of 10 to make the proportions more visually understandable in</span></pre>
                                                    <pre>       <span class="c1"># the plot)</span></pre>
                                    
                                                    <pre>       <span class="n">u</span> <span class="o">=</span> <span class="n">propermot_ra_sf_new</span><span class="o">*</span><span class="mi">10</span></pre>
                                                    <pre>       <span class="n">v</span> <span class="o">=</span> <span class="n">propermot_de_sf_new</span><span class="o">*</span><span class="mi">10</span></pre>
                                    
                                                    <pre>       <span class="c1">## Herschel&#39;s plot</span></pre>
                                                    <pre>       <span class="c1"># Reduce the quality of the image to display</span></pre>
                                                    <pre>       <span class="n">small</span> <span class="o">=</span> <span class="n">block_reduce</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_block</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1"># When the mouse is moving through the plot, the coordinates will appear</span></pre>
                                                    <pre>       <span class="n">TOOLTIPS</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;(RA,DEC)&quot;</span><span class="p">,</span><span class="s2">&quot;($x,$y)&quot;</span><span class="p">),(</span><span class="s2">&quot;Valor&quot;</span><span class="p">,</span><span class="s2">&quot;@image&quot;</span><span class="p">)]</span></pre>
                                    
                                                    <pre>       <span class="c1"># Creation of the image</span></pre>
                                                    <pre>       <span class="n">main_plot</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">x_range</span><span class="o">=</span><span class="p">(</span><span class="n">ralist</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">ralist</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="n">declist</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">declist</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="n">tooltips</span><span class="o">=</span><span class="n">TOOLTIPS</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="n">color_mapper</span> <span class="o">=</span> <span class="n">LogColorMapper</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Viridis256&quot;</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">im</span><span class="p">),</span> <span class="n">high</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">im</span><span class="p">))</span></pre>
                                    
                                                    <pre>       <span class="c1"># Add to the plot the Herschel image</span></pre>
                                                    <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="p">[</span><span class="n">small</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">ralist</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">declist</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">dw</span><span class="o">=</span><span class="p">(</span><span class="n">ralist</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">ralist</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">dh</span><span class="o">=</span><span class="p">(</span><span class="n">declist</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">-</span><span class="n">declist</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">color_mapper</span><span class="o">=</span><span class="n">color_mapper</span><span class="p">)</span></pre>
                                                    <pre>       <span class="n">color_bar</span> <span class="o">=</span> <span class="n">ColorBar</span><span class="p">(</span><span class="n">color_mapper</span><span class="o">=</span><span class="n">color_mapper</span><span class="p">,</span> <span class="n">ticker</span><span class="o">=</span><span class="n">LogTicker</span><span class="p">(),</span> <span class="n">label_standoff</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">border_line_color</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span></pre>
                                                    <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">color_bar</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1"># Creation of the points that represent the stars and their color</span></pre>
                                                    <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#FFD700&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;#FF8C00&quot;</span> <span class="p">,</span><span class="n">radius</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">)</span></pre>
                                    
                                                    <pre>       <span class="c1"># Creation of the arrows of each star representing their proper motions.</span></pre>
                                                    <pre>       <span class="c1"># The color is chosen too</span></pre>
                                    
                                                    <pre>       <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span></pre>
                                                    <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">add_layout</span><span class="p">(</span><span class="n">Arrow</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="n">VeeHead</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">y_start</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">x_end</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="n">m</span><span class="p">],</span> <span class="n">y_end</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">m</span><span class="p">]))</span></pre>
                                    
                                                    <pre>       <span class="c1"># Title of the axis and units</span></pre>
                                                    <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span><span class="o">=</span><span class="s2">&quot;Right Ascension (Degrees)&quot;</span></pre>
                                                    <pre>       <span class="n">main_plot</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span><span class="o">=</span><span class="s2">&quot;Declination (Degrees)&quot;</span></pre>
                                    
                                                    <pre>       <span class="n">show</span><span class="p">(</span><span class="n">main_plot</span><span class="p">)</span></pre>
                                                    <pre>       <span class="n">save_plot</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;Gaia y Herschel&quot;</span><span class="p">,</span> <span class="n">main_plot</span><span class="p">)</span> <span class="c1"># open a browser</span></pre>
                                        </code>
                                    </div>
                                    </div>



                                <h5 class="text-left mt-4">3.2 - Gaia_Herschel.json</h5>
                                <div class="highlight-json notranslate text-left">
                                    <div class="highlight p-4">
                                        <code>
                                    <pre><span class="p">{</span><span class="nt">&quot;algorithm&quot;</span><span class="p">:{</span></pre>
                                    <pre>   <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;Gaia_Herschel&quot;</span><span class="p">,</span></pre>
                                    <pre>   <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Plot Gaia and Herschel data&quot;</span><span class="p">,</span></pre>
                                    <pre>   <span class="nt">&quot;input&quot;</span><span class="p">:{</span></pre>
                                        <pre>       <span class="nt">&quot;input_1&quot;</span><span class="p">:{</span></pre>
                                            <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;gaia_table&quot;</span><span class="p">,</span></pre>
                                            <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Gaia VOTable&quot;</span><span class="p">,</span></pre>
                                            <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;gaia_table&quot;</span></pre>
                                        <pre>       <span class="p">},</span></pre>
                                        <pre>       <span class="nt">&quot;input_2&quot;</span><span class="p">:{</span></pre>
                                                <pre            ><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;hsa_table&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Herschel FITS&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;hsa_table&quot;</span></pre>
                                        <pre>       <span class="p">},</span></pre>
                                        <pre>       <span class="nt">&quot;input_3&quot;</span><span class="p">:{</span></pre>
                                                <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;number_stars_displayed&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Number of the stars&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;float&quot;</span></pre>
                                        <pre>       <span class="p">},</span></pre>
                                        <pre>       <span class="nt">&quot;input_4&quot;</span><span class="p">:{</span></pre>
                                                <pre>           <span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;size_block&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;view_name&quot;</span><span class="p">:</span><span class="s2">&quot;Size of the block&quot;</span><span class="p">,</span></pre>
                                                <pre>           <span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;integer&quot;</span></pre>
                                        <pre>       <span class="p">}</span></pre>
                            
                                <pre>   <span class="p">}</span></pre>
                                <pre><span class="p">}}</span></pre>
                            </code>
                            </div>
                            </div> -->
                                <!-- <h3 class="text-left mt-4"><b>4 - How to query the Gaia Archive</b></h3>
                                <ol>
                                    <li class="li_guide text-left">Go to the Gaia section in Queries:</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_menu.png' %}" style="width: 20%; max-width: 300px" alt="image of Menu Gaia Selected"><br><br>
                                    <li class="li_guide text-left">Configure the query according to your preferences.</li>
                                    <li class="li_guide text-left">Click on “Submit”</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_submit.png' %}" alt="image of Gaia Query"><br><br>
                                </ol> -->
                                <!-- <h3 class="text-left"><b>5 - How to query the Herschel Archive</b></h3>
                                <ol>
                                    <li class="li_guide text-left">Go to the Herschel section in Queries:</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/herschel_menu.png' %}" style="width: 20%; max-width: 300px" alt="image of Menu Gaia Selected"><br><br>
                                    <li class="li_guide text-left">Configure the query according to your preferences.</li>
                                    <li class="li_guide text-left">Click on “Submit”</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/herschel_submit.png' %}" alt="image of Gaia Query"><br><br>
                                </ol> -->
                                <!-- <h3 class="text-left"><b>6 - How to check the queries status</b></h3>
                                <ol>
                                    <li class="li_guide text-left">Go to the Status section in Queries.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/query_status_section.png' %}" alt="image of Query Status"><br><br>
                                </ol> -->
                                <!-- <h3 class="text-left"><b>7 - How to use the algorithm “Gaia Data with their Proper Motions (PM)”</b></h3>
                                <ol>
                                    <li class="li_guide text-left">Go to the Start section in Algorithms and click on “Gaia Data with their Proper Motions (PM)”.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_pm_algorithm_1.png' %}" alt="image of Start Algorithm"><br><br>
                                    <li class="li_guide text-left">Select an available VOTable. If none are available, click on “Launch Gaia Query” and set it according to your preferences.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_pm_algorithm_2.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                    <li class="li_guide text-left">Enter the number of stars plotted and click on “Run”</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_pm_algorithm_3.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                    <p class="text">After a few seconds, you will be redirected to the “Pipeline Status” page where the algorithm’s execution status will be reported.</p>
                                    <li class="li_guide text-left">Once the execution is finished, click on the execution and you will see the figure, the results and the different options available.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_pm_algorithm_4.png' %}" alt="image of Query Status"><br><br>
                                </ol> -->
                                <!-- <h3 class="text-left"><b>8 - How to use the algorithm “Plot Gaia and Herschel data”</b></h3>
                                <ol>
                                    <li class="li_guide text-left">Go to the Start section in Algorithms and click on “Plot Gaia and Herschel data”</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_1.png' %}" alt="image of Start Algorithm"><br><br>
                                    <li class="li_guide text-left">Enter the size of the block to reduce the quality of the image. Size of the block = 1 will return an image with the highest quality.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_2.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                    <li class="li_guide text-left">Select an available FITS. If none are available, click on “Launch Herschel Query” and set it according to your preferences.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_3.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                    <li class="li_guide text-left">Enter the number of stars plotted.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_4.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                    <li class="li_guide text-left">Select an available VOTable and click on “Run”. If none are available, click on “Launch Gaia Query” and set it according to your preferences.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_5.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                    <p class="text">After a few seconds, you will be redirected to the “Pipeline Status” page where the algorithm’s execution status will be reported.</p>
                                    <li class="li_guide text-left">Once the execution is finished, click on the execution and you will see the figure, the results and the different options available.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/gaia_herschel_algorithm_6.png' %}" alt="image of Query Status"><br><br>
                                </ol> -->
                                <!-- <h3 class="text-left"><b>9 - How to use the algorithm “Wien Law and Hertzsprung-Russell Diagram (HRD)”</b></h3>
                                <ol>
                                    <li class="li_guide text-left">Go to the Start section in Algorithms and click on “Wien Law and Hertzsprung-Russell Diagram (HRD)”.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/wien_algorithm_1.png' %}" alt="image of Start Algorithm"><br><br>
                                    <li class="li_guide text-left">Enter “y” or “n” depending on whether you want the star’s radius to be proportional to the real radius.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/wien_algorithm_2.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                    <li class="li_guide text-left">Enter the number of stars plotted.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/wien_algorithm_3.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                    <li class="li_guide text-left">Select an available VOTable and click on “Run”. If none are available, click on “Launch Gaia Query” and set it according to your preferences.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/wien_algorithm_4.png' %}" style="max-width: 400px" alt="image of Start Algorithm"><br><br>
                                    <p class="text">After a few seconds, you will be redirected to the “Pipeline Status” page where the algorithm’s execution status will be reported.</p>
                                    <li class="li_guide text-left">Once the execution is finished, click on the execution and you will see the figure, the results and the different options available.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/wien_algorithm_5.png' %}" alt="image of Query Status"><br><br>
                                </ol> -->
                                <!-- <h3 class="text-left"><b>10 - How to find my files</b></h3>
                                <ol>
                                    <li class="li_guide text-left">Go to the Data section and click on “File Manager”.</li>
                                    <img class="sfm-center index-img" src="{% static 'avi/img/deavi_structure/filemanager_1.png' %}" alt="image of File Manager"><br><br>
                                </ol>

                                <ul>
                                    <li class="li_guide text-left"><b>Sources</b>: This folder in turn contains the files obtained from Gaia and Herschel (hsa) queries.</li>
                                    <li class="li_guide text-left"><b>Results</b>: It contains all the files generated by the algorithms as results.</li>
                                    <li class="li_guide text-left"><b>User</b>: It contains any files uploaded by the user.</
                                </ul> -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- ------------------------------------------------------------- -->
                <!-- ------------------------------------------------------------- -->
                <!-- ------------------------------------------------------------- -->
            </div>
        </div>
    </div>
    {% include "avi/footer.html" %}
</body>

</html>